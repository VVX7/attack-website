Title: Filter Network Traffic-enterprise
Template: mitigations/mitigation
save_as: mitigations/M1037/index.html
data: {"attack_id": "M1037", "domain": "enterprise", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/enterprise/", "children": [{"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "Behavior Prevention on Endpoint", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "Credential Access Protection", "path": "/mitigations/M1043/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M1053/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "Environment Variable Permissions", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M1037/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "Limit Software Installation", "path": "/mitigations/M1033/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M1028/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M1027/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "Privileged Process Integrity", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "Remote Data Storage", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M1021/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "User Account Control", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M1017/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M1016/", "children": []}]}, "side_menu_mobile_view_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/enterprise/", "children": [{"name": "A-C", "id": "512df49fe07448598eb675274b08bbb3", "path": null, "children": [{"name": "Account Use Policies", "id": "73c761167c984f1189a674ca42878893", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "9a77cc54cd41443a8b2e90f852b97ea9", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "3b7dafbfe48b4b5aa8e46de1ca5773df", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "459e1913ea284623aebae274565327a5", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "c01b115df44c455ca1c33b82ee80007f", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "8280d591a48d442da10f0c0621abe8b4", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "07521c4d864c4f9fb9f9256377bada45", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "e65add858d0b4929b4ef141825759bc3", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "d4d78ee5fa714998a4bcc5bc29d39303", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "3a4b6639c22942ada8c945b708ad1661", "path": "/mitigations/M1043/", "children": []}]}, {"name": "D-F", "id": "3d388340b6c9425dac15d51e5a31c70e", "path": null, "children": [{"name": "Data Backup", "id": "7b20f13e998d47adb5e095bf35b915be", "path": "/mitigations/M1053/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "2fe930c90d5b483783dc036cf8e64e39", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "8235ee3a46b74feda1e9491e3a2e7d9c", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "cb69b4db3de947a8b08e48990aab7bae", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "07497cf4782144319466c8dbed1509b2", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "bb6e4085281149c0940fb78c31d21c81", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "6763aa47ef3244279d215595d33b6943", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "7b9ba899f0504b4e9b38b3997cb90acb", "path": "/mitigations/M1037/", "children": []}]}, {"name": "G-I", "id": "94e00630ebea47c5860dab32f8d7d503", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}, {"name": "J-L", "id": "42264753851f4b098250fc6ac6f92364", "path": null, "children": [{"name": "Limit Access to Resource Over Network", "id": "2d0fe285de7f47259617e7ec5b415fc1", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "46a2a99bb52149519d063d8891345471", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "16dbf953736e4753bb077e5d88dce768", "path": "/mitigations/M1033/", "children": []}]}, {"name": "M-O", "id": "123a56516d6341c3934634153896df86", "path": null, "children": [{"name": "Multi-factor Authentication", "id": "8ad64a6f4a8a4ff681280ea9fd217854", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "f09a68bd759e455dbe397112fd26a881", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "33b23beb0cf24e7894f9117c2267f401", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "0f929aa201fd4a56a9a7d6fd5a8b733b", "path": "/mitigations/M1028/", "children": []}]}, {"name": "P-R", "id": "b6eea37d43d64f339e2b03386d0aeb59", "path": null, "children": [{"name": "Password Policies", "id": "ba14a663205448abb799d509381c25cf", "path": "/mitigations/M1027/", "children": []}, {"name": "Privileged Account Management", "id": "7227b0d583334f219a1053435b09898d", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "46381f3cc3ae48538c8a0eccf1898b9f", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "f3c59046d2b044c8830c855225ab4aac", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "6fc1145a86f049068e49f2c89325547e", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "b5aa080cb48c49f9a8dd777676f90ddc", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "d83a1909434b4ee7ab8b0a71445f07db", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "28b5148ef0484d5a8556aa7a7f3fd45c", "path": "/mitigations/M1021/", "children": []}]}, {"name": "S-U", "id": "9258e462256d4412a50167078f712663", "path": null, "children": [{"name": "Software Configuration", "id": "11fda1b090344084b8a1605c250cfc0e", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "4203dbe83cea492ba17677c1ba9091b9", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "5f8512ea58ff4c1c9224e3a1b06a33b3", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "bb239edcac49418487695bce2cdd18fd", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "816da93817b84a72a3e9114029a9b252", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "a43c9616cd074cde97c731ddd9e4ceee", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "ee740ebdc9c24ef78eaebb0df6f9a000", "path": "/mitigations/M1017/", "children": []}]}, {"name": "V-X", "id": "1a4bddc3293f4a64884575e0fce7103d", "path": null, "children": [{"name": "Vulnerability Scanning", "id": "f2a4a53579bd4513a7884f74404d1682", "path": "/mitigations/M1016/", "children": []}]}, {"name": "Y-Z", "id": "25d93268bd414d8cb311ee805171c04e", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}]}, "name": "Filter Network Traffic", "descr": "<p>Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.</p>", "version": "1.1", "techniques_addressed_data": [{"tid": "T1197", "domain": "Enterprise", "name": "BITS Jobs", "descr": "<p>Modify network and/or host firewall rules, as well as other network controls, to only allow legitimate BITS traffic.</p>"}, {"tid": "T1522", "domain": "Enterprise", "name": "Cloud Instance Metadata API", "descr": "<p>Limit access to the Instance Metadata API using a host-based firewall such as iptables. A properly configured Web Application Firewall (WAF) may help prevent external adversaries from exploiting Server-side Request Forgery (SSRF) attacks that allow access to the Cloud Instance Metadata API.<span onclick=scrollToRef('scite-7') id=\"scite-ref-7-a\" class=\"scite-citeref-number\" data-reference=\"RedLock Instance Metadata API 2018\"><sup><a href=\"https://redlock.io/blog/instance-metadata-api-a-modern-day-trojan-horse\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span></p>"}, {"tid": "T1094", "domain": "Enterprise", "name": "Custom Command and Control Protocol", "descr": "<p>Filter network traffic to look for unusual or non-standard protocols.</p>"}, {"tid": "T1530", "domain": "Enterprise", "name": "Data from Cloud Storage Object", "descr": "<p>Cloud service providers support IP-based restrictions when accessing cloud resources. Consider using IP whitelisting along with user account management to ensure that data access is restricted not only to valid users but only from expected IP ranges to mitigate the use of stolen credentials to access data.</p>"}, {"tid": "T1499", "domain": "Enterprise", "name": "Endpoint Denial of Service", "descr": "<p>Leverage services provided by Content Delivery Networks (CDN) or providers specializing in DoS mitigations to filter traffic upstream from services. Filter boundary traffic by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport. To defend against SYN floods, enable SYN Cookies.<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"CERT-EU DDoS March 2017\"><sup><a href=\"http://cert.europa.eu/static/WhitePapers/CERT-EU_Security_Whitepaper_DDoS_17-003.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}, {"tid": "T1048", "domain": "Enterprise", "name": "Exfiltration Over Alternative Protocol", "descr": "<p>Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network.</p>"}, {"tid": "T1187", "domain": "Enterprise", "name": "Forced Authentication", "descr": "<p>Block SMB traffic from exiting an enterprise network with egress filtering or by blocking TCP ports 139, 445 and UDP port 137. Filter or block WebDAV protocol traffic from exiting the network. If access to external resources over SMB and WebDAV is necessary, then traffic should be tightly limited with whitelisting.<span onclick=scrollToRef('scite-2') id=\"scite-ref-2-a\" class=\"scite-citeref-number\" data-reference=\"US-CERT SMB Security\"><sup><a href=\"https://www.us-cert.gov/ncas/current-activity/2017/01/16/SMB-Security-Best-Practices\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span><span onclick=scrollToRef('scite-3') id=\"scite-ref-3-a\" class=\"scite-citeref-number\" data-reference=\"US-CERT APT Energy Oct 2017\"><sup><a href=\"https://www.us-cert.gov/ncas/alerts/TA17-293A\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p>"}, {"tid": "T1171", "domain": "Enterprise", "name": "LLMNR/NBT-NS Poisoning and Relay", "descr": "<p>Use host-based security software to block LLMNR/NetBIOS traffic. Enabling SMB Signing can stop NTLMv2 relay attacks.<span onclick=scrollToRef('scite-4') id=\"scite-ref-4-a\" class=\"scite-citeref-number\" data-reference=\"byt3bl33d3r NTLM Relaying\"><sup><a href=\"https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span><span onclick=scrollToRef('scite-5') id=\"scite-ref-5-a\" class=\"scite-citeref-number\" data-reference=\"Secure Ideas SMB Relay\"><sup><a href=\"https://blog.secureideas.com/2018/04/ever-run-a-relay-why-smb-relays-should-be-on-your-mind.html\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span><span onclick=scrollToRef('scite-6') id=\"scite-ref-6-a\" class=\"scite-citeref-number\" data-reference=\"Microsoft SMB Packet Signing\"><sup><a href=\"https://docs.microsoft.com/en-us/previous-versions/system-center/operations-manager-2005/cc180803(v=technet.10)\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p>"}, {"tid": "T1188", "domain": "Enterprise", "name": "Multi-hop Proxy", "descr": "<p>Traffic to known anonymity networks and C2 infrastructure can be blocked through the use of network black and white lists. It should be noted that this kind of blocking may be circumvented by other techniques like <a href=\"/techniques/T1172\">Domain Fronting</a>.</p>"}, {"tid": "T1498", "domain": "Enterprise", "name": "Network Denial of Service", "descr": "<p>When flood volumes exceed the capacity of the network connection being targeted, it is typically necessary to intercept the incoming traffic upstream to filter out the attack traffic from the legitimate traffic. Such defenses can be provided by the hosting Internet Service Provider (ISP) or by a 3rd party such as a Content Delivery Network (CDN) or providers specializing in DoS mitigations.</p><p>Depending on flood volume, on-premises filtering may be possible by blocking source addresses sourcing the attack, blocking ports that are being targeted, or blocking protocols being used for transport.</p><p>As immediate response may require rapid engagement of 3rd parties, analyze the risk associated to critical resources being affected by Network DoS attacks and create a disaster recovery plan/business continuity plan to respond to incidents.<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"CERT-EU DDoS March 2017\"><sup><a href=\"http://cert.europa.eu/static/WhitePapers/CERT-EU_Security_Whitepaper_DDoS_17-003.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span><span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"CERT-EU DDoS March 2017\"><sup><a href=\"http://cert.europa.eu/static/WhitePapers/CERT-EU_Security_Whitepaper_DDoS_17-003.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span><span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"CERT-EU DDoS March 2017\"><sup><a href=\"http://cert.europa.eu/static/WhitePapers/CERT-EU_Security_Whitepaper_DDoS_17-003.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}, {"tid": "T1205", "domain": "Enterprise", "name": "Port Knocking", "descr": "<p>Mitigation of some variants of this technique could be achieved through the use of stateful firewalls, depending upon how it is implemented.</p>"}, {"tid": "T1219", "domain": "Enterprise", "name": "Remote Access Tools", "descr": "<p>Properly configure firewalls, application firewalls, and proxies to limit outgoing traffic to sites and services used by remote access tools.</p>"}, {"tid": "T1095", "domain": "Enterprise", "name": "Standard Non-Application Layer Protocol", "descr": "<p>Filter network traffic to prevent use of protocols across the network boundary that are unnecessary.</p>"}, {"tid": "T1537", "domain": "Enterprise", "name": "Transfer Data to Cloud Account", "descr": "<p>Implement network-based filtering restrictions to prohibit data transfers to untrusted VPCs.</p>"}, {"tid": "T1078", "domain": "Enterprise", "name": "Valid Accounts", "descr": "<p>Cloud service providers support IP-based restrictions when accessing cloud resources. Consider using IP whitelisting on cloud-based systems along with user account management to ensure that data access is restricted not only to valid users but only from expected IP ranges to mitigate the use of stolen credentials to access data.</p>"}], "bottom_ref": [{"description": "Meintanis, S., Revuelto, V., Socha, K.. (2017, March 10). DDoS Overview and Response Guide. Retrieved April 24, 2019.", "url": "http://cert.europa.eu/static/WhitePapers/CERT-EU_Security_Whitepaper_DDoS_17-003.pdf", "sname": "CERT-EU DDoS March 2017", "number": 1}, {"description": "US-CERT. (2017, March 16). SMB Security Best Practices. Retrieved December 21, 2017.", "url": "https://www.us-cert.gov/ncas/current-activity/2017/01/16/SMB-Security-Best-Practices", "sname": "US-CERT SMB Security", "number": 2}, {"description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.", "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A", "sname": "US-CERT APT Energy Oct 2017", "number": 3}, {"description": "Salvati, M. (2017, June 2). Practical guide to NTLM Relaying in 2017 (A.K.A getting a foothold in under 5 minutes). Retrieved February 7, 2019.", "url": "https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html", "sname": "byt3bl33d3r NTLM Relaying", "number": 4}, {"description": "Kuehn, E. (2018, April 11). Ever Run a Relay? Why SMB Relays Should Be On Your Mind. Retrieved February 7, 2019.", "url": "https://blog.secureideas.com/2018/04/ever-run-a-relay-why-smb-relays-should-be-on-your-mind.html", "sname": "Secure Ideas SMB Relay", "number": 5}, {"description": "Microsoft. (2008, September 10). Using SMB Packet Signing. Retrieved February 7, 2019.", "url": "https://docs.microsoft.com/en-us/previous-versions/system-center/operations-manager-2005/cc180803(v=technet.10)", "sname": "Microsoft SMB Packet Signing", "number": 6}, {"description": "Higashi, Michael. (2018, May 15). Instance Metadata API: A Modern Day Trojan Horse. Retrieved July 16, 2019.", "url": "https://redlock.io/blog/instance-metadata-api-a-modern-day-trojan-horse", "sname": "RedLock Instance Metadata API 2018", "number": 7}]}