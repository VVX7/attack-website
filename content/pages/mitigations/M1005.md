Title: Application Vetting-mobile
Template: mitigations/mitigation
save_as: mitigations/M1005/index.html
data: {"attack_id": "M1005", "domain": "mobile", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/mobile/", "children": [{"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Vetting", "id": "Application Vetting", "path": "/mitigations/M1005/", "children": []}, {"name": "Attestation", "id": "Attestation", "path": "/mitigations/M1002/", "children": []}, {"name": "Caution with Device Administrator Access", "id": "Caution with Device Administrator Access", "path": "/mitigations/M1007/", "children": []}, {"name": "Deploy Compromised Device Detection Method", "id": "Deploy Compromised Device Detection Method", "path": "/mitigations/M1010/", "children": []}, {"name": "Encrypt Network Traffic", "id": "Encrypt Network Traffic", "path": "/mitigations/M1009/", "children": []}, {"name": "Enterprise Policy", "id": "Enterprise Policy", "path": "/mitigations/M1012/", "children": []}, {"name": "Interconnection Filtering", "id": "Interconnection Filtering", "path": "/mitigations/M1014/", "children": []}, {"name": "Lock Bootloader", "id": "Lock Bootloader", "path": "/mitigations/M1003/", "children": []}, {"name": "Security Updates", "id": "Security Updates", "path": "/mitigations/M1001/", "children": []}, {"name": "System Partition Integrity", "id": "System Partition Integrity", "path": "/mitigations/M1004/", "children": []}, {"name": "Use Recent OS Version", "id": "Use Recent OS Version", "path": "/mitigations/M1006/", "children": []}, {"name": "User Guidance", "id": "User Guidance", "path": "/mitigations/M1011/", "children": []}]}, "side_menu_mobile_view_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/mobile/", "children": [{"name": "A-C", "id": "f7b1b6f6584d4396a45d0c920336c93c", "path": null, "children": [{"name": "Application Developer Guidance", "id": "f6014819b6004e6b99ecf326b33c9665", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Vetting", "id": "23d6d5cdbf3f4a3c94f265741fae98df", "path": "/mitigations/M1005/", "children": []}, {"name": "Attestation", "id": "0ea2c154cf2b433fb46331e4c795e5aa", "path": "/mitigations/M1002/", "children": []}, {"name": "Caution with Device Administrator Access", "id": "b53e0a274c384680a95d6cdbd156d053", "path": "/mitigations/M1007/", "children": []}]}, {"name": "D-F", "id": "734fefa2c84a4bcdae8a13ef0eebaecd", "path": null, "children": [{"name": "Deploy Compromised Device Detection Method", "id": "86075c9e3a5945608fdaeed0af9bd4ab", "path": "/mitigations/M1010/", "children": []}, {"name": "Encrypt Network Traffic", "id": "1dfb6c444350459e871cbee1c30275b5", "path": "/mitigations/M1009/", "children": []}, {"name": "Enterprise Policy", "id": "a2c8a3142ea34b888fa6f24a87806f61", "path": "/mitigations/M1012/", "children": []}]}, {"name": "G-I", "id": "06cefa91faf14ea4a9ab790456995ab9", "path": null, "children": [{"name": "Interconnection Filtering", "id": "f6a273bbbbff44f399ed9c89246e3311", "path": "/mitigations/M1014/", "children": []}]}, {"name": "J-L", "id": "969a6266c3754a42b91244c99b95ca9d", "path": null, "children": [{"name": "Lock Bootloader", "id": "4d1081995544467789d74e4430713e51", "path": "/mitigations/M1003/", "children": []}]}, {"name": "M-O", "id": "d27c55c8fce64ef3a67ef162693302b3", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}, {"name": "P-R", "id": "1a69b4e63a8f4b6a8fbcb18cdb540a35", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}, {"name": "S-U", "id": "0331ff4fb8b54f61a3e8334c05af56fa", "path": null, "children": [{"name": "Security Updates", "id": "8df4afb34f1d4347bb53099455cd32af", "path": "/mitigations/M1001/", "children": []}, {"name": "System Partition Integrity", "id": "4582924f9b144ac6b6b16467d9a464c6", "path": "/mitigations/M1004/", "children": []}, {"name": "Use Recent OS Version", "id": "be9c8c186c69414fba4c0cf3693d2f6a", "path": "/mitigations/M1006/", "children": []}, {"name": "User Guidance", "id": "6ba939fe71d6403d86f572fd9f7728dc", "path": "/mitigations/M1011/", "children": []}]}, {"name": "V-X", "id": "366b93b1a3f54add9b301215c5d4ca54", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}, {"name": "Y-Z", "id": "af3a096fb3d14975a23285e32bc11abb", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}]}, "name": "Application Vetting", "descr": "<p>Enterprises can vet applications for exploitable vulnerabilities or unwanted (privacy-invasive or malicious) behaviors. Enterprises can inspect applications themselves or use a third-party service.</p><br><p>Enterprises may impose policies to only allow pre-approved applications to be installed on their devices or may impose policies to block use of specific applications known to have issues. In Bring Your Own Device (BYOD) environments, enterprises may only be able to impose these policies over an enterprise-managed portion of the device.</p><br><p>Application Vetting is not a complete mitigation. Techniques such as <a href=\"/techniques/T1440\">Detect App Analysis Environment</a> exist that can enable adversaries to bypass vetting.</p>", "version": "1.0", "techniques_addressed_data": [{"tid": "T1453", "domain": "Mobile", "name": "Abuse Accessibility Features", "descr": "<p>Enterprises could perform app vetting before allowing apps to be installed on devices and search for abuse of accessibility features as part of the analysis, or otherwise use mobile app reputation services to search for known malicious apps.</p>"}, {"tid": "T1401", "domain": "Mobile", "name": "Abuse Device Administrator Access to Prevent Removal", "descr": "<p>It is rare for applications to utilize Device Administrator access. App vetting can detect apps that do so, and those apps should be closely scrutinized. A static analysis approach can be used to identify ransomware apps including apps that abuse Device Administrator access.<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"Maggi-Ransomware\"><sup><a href=\"https://www.blackhat.com/docs/eu-16/materials/eu-16-Maggi-Pocket-Sized-Badness-Why-Ransomware-Comes-As-A-Plot-Twist-In-The-Cat-Mouse-Game.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}, {"tid": "T1435", "domain": "Mobile", "name": "Access Calendar Entries", "descr": "<p>On Android, accessing device calendar data requires that the app hold the READ_CALENDAR permission. Apps that request this permission could be closely scrutinized to ensure that the request is appropriate. On iOS, the app vetting process can determine whether apps access device calendar data, with extra scrutiny applied to any that do so.</p>"}, {"tid": "T1433", "domain": "Mobile", "name": "Access Call Log", "descr": "<p>On Android, accessing the device call log requires that the app hold the READ_CALL_LOG permission. Apps that request this permission could be closely scrutinized to ensure that the request is appropriate.</p>"}, {"tid": "T1432", "domain": "Mobile", "name": "Access Contact List", "descr": "<p>On Android, accessing the device contact list requires that the app hold the READ_CONTACTS permission. Apps that request this permission could be closely scrutinized to ensure that the request is appropriate. On iOS, the app vetting process can determine whether apps access the device contact list, with extra scrutiny applied to any that do so.</p>"}, {"tid": "T1413", "domain": "Mobile", "name": "Access Sensitive Data in Device Logs"}, {"tid": "T1409", "domain": "Mobile", "name": "Access Stored Application Data", "descr": "<p>Ensure applications do not store data in an insecure fashion, such as in unprotected external storage, without acknowledging the risk that the data can potentially be accessed or modified by other applications.</p>"}, {"tid": "T1416", "domain": "Mobile", "name": "Android Intent Hijacking", "descr": "<p>When vetting applications for potential security weaknesses, the vetting process could look for insecure use of intents. Developers should be encouraged to use techniques to ensure that the intent can only be sent to an appropriate destination (e.g., use explicit rather than implicit intents, permission checking, checking of the destination app's signing certificate, or the App Links feature added in Android 6.0). For mobile applications using OAuth, encourage use of best practice.<span onclick=scrollToRef('scite-3') id=\"scite-ref-3-a\" class=\"scite-citeref-number\" data-reference=\"IETF-OAuthNativeApps\"><sup><a href=\"https://tools.ietf.org/html/rfc8252\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span><span onclick=scrollToRef('scite-4') id=\"scite-ref-4-a\" class=\"scite-citeref-number\" data-reference=\"Android-AppLinks\"><sup><a href=\"https://developer.android.com/training/app-links/index.html\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>"}, {"tid": "T1402", "domain": "Mobile", "name": "App Auto-Start at Device Boot", "descr": "<p>Enterprises could potentially vet apps before allowing their use on devices, and carefully scrutinize apps that declare a BroadcastReceiver containing an intent-filter for BOOT_COMPLETED. Unfortunately this is likely not practical due to the vast number of apps with this behavior.</p>"}, {"tid": "T1418", "domain": "Mobile", "name": "Application Discovery", "descr": "<p>Application vetting techniques could search for use of the Android PackageManager class to enumerate other apps, and such applications could have extra scrutiny applied to them. However, this technique may not be practical if many apps invoke these methods as part of their legitimate behavior. On iOS, application vetting techniques could similarly search for use of the private API call necessary to obtain a list of apps installed on the device. Additionally, on iOS, use of the private API call is likely to result in the app not being accepted into Apple's App Store.</p>"}, {"tid": "T1429", "domain": "Mobile", "name": "Capture Audio", "descr": "<p>Applications using the android permission <code>android.permission.RECORD_AUDIO</code> or iOS applications using <code>RequestRecordPermission</code> could be more closely scrutinized and monitored. If <code>android.permission.CAPTURE_AUDIO_OUTPUT</code> is found in a third-party application, it should be heavily scrutinized.</p>"}, {"tid": "T1512", "domain": "Mobile", "name": "Capture Camera", "descr": "<p>During the vetting process applications using the android permission <code>android.permission.CAMERA</code>, or the iOS <code>NSCameraUsageDescription</code> plist entry could be analyzed more closely.</p>"}, {"tid": "T1414", "domain": "Mobile", "name": "Capture Clipboard Data", "descr": "<p>Applications could be vetted for their use of the clipboard manager APIs with extra scrutiny given to application that make use of them.</p>"}, {"tid": "T1412", "domain": "Mobile", "name": "Capture SMS Messages", "descr": "<p>Enterprises performing application vetting could search for applications that declare the RECEIVE_SMS permission and scrutinize them closely.</p>"}, {"tid": "T1510", "domain": "Mobile", "name": "Clipboard Modification", "descr": "<p>Applications could be vetted for their use of the clipboard manager APIs with extra scrutiny given to application that make use of them.</p>"}, {"tid": "T1471", "domain": "Mobile", "name": "Data Encrypted for Impact", "descr": "<p>A static analysis approach may be able to identify ransomware apps that encrypt user files on the device.<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"Maggi-Ransomware\"><sup><a href=\"https://www.blackhat.com/docs/eu-16/materials/eu-16-Maggi-Pocket-Sized-Badness-Why-Ransomware-Comes-As-A-Plot-Twist-In-The-Cat-Mouse-Game.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}, {"tid": "T1475", "domain": "Mobile", "name": "Deliver Malicious App via Authorized App Store", "descr": "<p>App store operators and enterprises could assess reputational characteristics of the app, including the popularity of the app or other apps from the same developer and whether or not security issues have been found in other apps from the same developer.</p>"}, {"tid": "T1446", "domain": "Mobile", "name": "Device Lockout", "descr": "<p>It is rare for applications to utilize Device Administrator access. App vetting can detect apps that do so, and those apps should be closely scrutinized. A static analysis approach can be used to identify ransomware apps including apps that abuse Device Administrator access.<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"Maggi-Ransomware\"><sup><a href=\"https://www.blackhat.com/docs/eu-16/materials/eu-16-Maggi-Pocket-Sized-Badness-Why-Ransomware-Comes-As-A-Plot-Twist-In-The-Cat-Mouse-Game.pdf\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}, {"tid": "T1407", "domain": "Mobile", "name": "Download New Code at Runtime", "descr": "<p>Application vetting techniques could (either statically or dynamically) look for indications that the application downloads and executes new code at runtime (e.g., on Android use of DexClassLoader, System.load, or the WebView JavaScriptInterface capability, or on iOS use of JSPatch or similar capabilities). Unfortunately, this is only a partial mitigation, as additional scrutiny would still need to be applied to applications that use these techniques, as the techniques are often used without malicious intent, and because applications may employ other techniques such as to hide their use of these techniques.</p>"}, {"tid": "T1523", "domain": "Mobile", "name": "Evade Analysis Environment", "descr": "<p>Applications attempting to get <code>android.os.SystemProperties</code> or <code>getprop</code> with the runtime <code>exec()</code> commands should be closely scrutinized. Google does not recommend the use of system properties within applications.</p>"}, {"tid": "T1404", "domain": "Mobile", "name": "Exploit OS Vulnerability", "descr": "<p>Application vetting may be able to identify the presence of exploit code within applications.</p>"}, {"tid": "T1405", "domain": "Mobile", "name": "Exploit TEE Vulnerability"}, {"tid": "T1472", "domain": "Mobile", "name": "Generate Fraudulent Advertising Revenue"}, {"tid": "T1417", "domain": "Mobile", "name": "Input Capture", "descr": "<p>Applications that attempt to register themselves as a device keyboard or request the <code>android.permission.BIND_ACCESSIBILITY_SERVICE</code> permission in a service declaration should be closely scrutinized during the vetting process.</p>"}, {"tid": "T1516", "domain": "Mobile", "name": "Input Injection", "descr": "<p>Applications that register an accessibility service should be scrutinized further for malicious behavior.</p>"}, {"tid": "T1411", "domain": "Mobile", "name": "Input Prompt"}, {"tid": "T1430", "domain": "Mobile", "name": "Location Tracking", "descr": "<p>On Android, applications must request the ACCESS_COARSE_LOCATION or ACCESS_FINE_LOCATION permission to access the device's physical location. Extra scrutiny could be given to applications that request these permissions. On iOS, calls to the relevant APIs could be detected during the vetting process.</p>"}, {"tid": "T1463", "domain": "Mobile", "name": "Manipulate Device Communication", "descr": "<p>Application vetting techniques can scan for use of cleartext communication, insecure TrustManager implementations, and other potential network communication weaknesses. The Google Play Store now automatically assesses submitted applications for insecure TrustManager implementations.<span onclick=scrollToRef('scite-5') id=\"scite-ref-5-a\" class=\"scite-citeref-number\" data-reference=\"Google-TrustManager\"><sup><a href=\"https://support.google.com/faqs/answer/6346016?hl=en\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>"}, {"tid": "T1410", "domain": "Mobile", "name": "Network Traffic Capture or Redirection", "descr": "<p>Closely scrutinize applications that request VPN access before allowing their use.</p>"}, {"tid": "T1406", "domain": "Mobile", "name": "Obfuscated Files or Information", "descr": "<p>Application vetting techniques may be able to alert to the presence of obfuscated or encrypted code in applications, and such applications could have extra scrutiny applied. Unfortunately, this mitigation is likely impractical, as many legitimate applications apply code obfuscation or encryption to resist adversary techniques such as Repackaged Application. Dynamic analysis when used in application vetting may in some cases be able to identify malicious code in obfuscated or encrypted form by detecting the code at execution time (after it is deobfuscated or decrypted). Some application vetting techniques apply reputation analysis of the application developer and can alert to potentially suspicious applications without actual examination of application code.</p>"}, {"tid": "T1448", "domain": "Mobile", "name": "Premium SMS Toll Fraud"}, {"tid": "T1424", "domain": "Mobile", "name": "Process Discovery", "descr": "<p>Application vetting techniques could be used to attempt to identify applications with this behavior.</p>"}, {"tid": "T1513", "domain": "Mobile", "name": "Screen Capture", "descr": "<p>Applications can be vetted for their use of the Android MediaProjectionManager class, with extra scrutiny applied to any application that uses the class.</p>"}, {"tid": "T1426", "domain": "Mobile", "name": "System Information Discovery", "descr": "<p>App vetting procedures can search for apps that use the android.os.Build class, but these procedures could potentially be evaded and are likely not practical in this case, as many apps are likely to use this functionality as part of their legitimate behavior.</p>"}, {"tid": "T1422", "domain": "Mobile", "name": "System Network Configuration Discovery", "descr": "<p>Application vetting could be used to analyze applications to determine whether they access this information, including determining whether the application requests the Android ACCESS_NETWORK_STATE permission (required in order to access NetworkInterface information) or the READ_PHONE_STATE permission (required in order to access TelephonyManager information).</p>"}, {"tid": "T1421", "domain": "Mobile", "name": "System Network Connections Discovery", "descr": "<p>During application vetting, applications could be examined to see if they have this behavior, and extra scrutiny could potentially be given to applications that do.</p>"}, {"tid": "T1509", "domain": "Mobile", "name": "Uncommonly Used Port", "descr": "<p>Application vetting reports may show network communications performed by the application, including hosts, ports, protocols, and URLs.</p>"}, {"tid": "T1415", "domain": "Mobile", "name": "URL Scheme Hijacking", "descr": "<p>Check for potential malicious definitions of URL schemes when vetting applications. Also, when examining apps for potential vulnerabilities, encourage use of universal links as an alternative to URL schemes. When examining apps that use OAuth, encourage use of best practices.<span onclick=scrollToRef('scite-2') id=\"scite-ref-2-a\" class=\"scite-citeref-number\" data-reference=\"Apple-UniversalLinks\"><sup><a href=\"https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span><span onclick=scrollToRef('scite-3') id=\"scite-ref-3-a\" class=\"scite-citeref-number\" data-reference=\"IETF-OAuthNativeApps\"><sup><a href=\"https://tools.ietf.org/html/rfc8252\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p>"}], "bottom_ref": [{"description": "Federico Maggi and Stefano Zanero. (2016). Pocket-Sized Badness - Why Ransomware Comes as a Plot Twist in the Cat-Mouse Game. Retrieved December 21, 2016.", "url": "https://www.blackhat.com/docs/eu-16/materials/eu-16-Maggi-Pocket-Sized-Badness-Why-Ransomware-Comes-As-A-Plot-Twist-In-The-Cat-Mouse-Game.pdf", "sname": "Maggi-Ransomware", "number": 1}, {"description": "Apple. (n.d.). Support Universal Links. Retrieved December 21, 2016.", "url": "https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html", "sname": "Apple-UniversalLinks", "number": 2}, {"description": "W. Denniss and J. Bradley. (2017, October). IETF RFC 8252: OAuth 2.0 for Native Apps. Retrieved November 30, 2018.", "url": "https://tools.ietf.org/html/rfc8252", "sname": "IETF-OAuthNativeApps", "number": 3}, {"description": "Android. (n.d.). Handling App Links. Retrieved December 21, 2016.", "url": "https://developer.android.com/training/app-links/index.html", "sname": "Android-AppLinks", "number": 4}, {"description": "Google. (n.d.). How to fix apps containing an unsafe implementation of TrustManager. Retrieved December 24, 2016.", "url": "https://support.google.com/faqs/answer/6346016?hl=en", "sname": "Google-TrustManager", "number": 5}]}