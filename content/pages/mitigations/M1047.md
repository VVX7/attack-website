Title: Audit-enterprise
Template: mitigations/mitigation
save_as: mitigations/M1047/index.html
data: {"attack_id": "M1047", "domain": "enterprise", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/enterprise/", "children": [{"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "Behavior Prevention on Endpoint", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "Credential Access Protection", "path": "/mitigations/M1043/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M1053/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "Environment Variable Permissions", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M1037/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "Limit Software Installation", "path": "/mitigations/M1033/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M1028/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M1027/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "Privileged Process Integrity", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "Remote Data Storage", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M1021/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "User Account Control", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M1017/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M1016/", "children": []}]}, "side_menu_mobile_view_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/enterprise/", "children": [{"name": "A-C", "id": "512df49fe07448598eb675274b08bbb3", "path": null, "children": [{"name": "Account Use Policies", "id": "73c761167c984f1189a674ca42878893", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "9a77cc54cd41443a8b2e90f852b97ea9", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "3b7dafbfe48b4b5aa8e46de1ca5773df", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "459e1913ea284623aebae274565327a5", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "c01b115df44c455ca1c33b82ee80007f", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "8280d591a48d442da10f0c0621abe8b4", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "07521c4d864c4f9fb9f9256377bada45", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "e65add858d0b4929b4ef141825759bc3", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "d4d78ee5fa714998a4bcc5bc29d39303", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "3a4b6639c22942ada8c945b708ad1661", "path": "/mitigations/M1043/", "children": []}]}, {"name": "D-F", "id": "3d388340b6c9425dac15d51e5a31c70e", "path": null, "children": [{"name": "Data Backup", "id": "7b20f13e998d47adb5e095bf35b915be", "path": "/mitigations/M1053/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "2fe930c90d5b483783dc036cf8e64e39", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "8235ee3a46b74feda1e9491e3a2e7d9c", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "cb69b4db3de947a8b08e48990aab7bae", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "07497cf4782144319466c8dbed1509b2", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "bb6e4085281149c0940fb78c31d21c81", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "6763aa47ef3244279d215595d33b6943", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "7b9ba899f0504b4e9b38b3997cb90acb", "path": "/mitigations/M1037/", "children": []}]}, {"name": "G-I", "id": "94e00630ebea47c5860dab32f8d7d503", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}, {"name": "J-L", "id": "42264753851f4b098250fc6ac6f92364", "path": null, "children": [{"name": "Limit Access to Resource Over Network", "id": "2d0fe285de7f47259617e7ec5b415fc1", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "46a2a99bb52149519d063d8891345471", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "16dbf953736e4753bb077e5d88dce768", "path": "/mitigations/M1033/", "children": []}]}, {"name": "M-O", "id": "123a56516d6341c3934634153896df86", "path": null, "children": [{"name": "Multi-factor Authentication", "id": "8ad64a6f4a8a4ff681280ea9fd217854", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "f09a68bd759e455dbe397112fd26a881", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "33b23beb0cf24e7894f9117c2267f401", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "0f929aa201fd4a56a9a7d6fd5a8b733b", "path": "/mitigations/M1028/", "children": []}]}, {"name": "P-R", "id": "b6eea37d43d64f339e2b03386d0aeb59", "path": null, "children": [{"name": "Password Policies", "id": "ba14a663205448abb799d509381c25cf", "path": "/mitigations/M1027/", "children": []}, {"name": "Privileged Account Management", "id": "7227b0d583334f219a1053435b09898d", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "46381f3cc3ae48538c8a0eccf1898b9f", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "f3c59046d2b044c8830c855225ab4aac", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "6fc1145a86f049068e49f2c89325547e", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "b5aa080cb48c49f9a8dd777676f90ddc", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "d83a1909434b4ee7ab8b0a71445f07db", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "28b5148ef0484d5a8556aa7a7f3fd45c", "path": "/mitigations/M1021/", "children": []}]}, {"name": "S-U", "id": "9258e462256d4412a50167078f712663", "path": null, "children": [{"name": "Software Configuration", "id": "11fda1b090344084b8a1605c250cfc0e", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "4203dbe83cea492ba17677c1ba9091b9", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "5f8512ea58ff4c1c9224e3a1b06a33b3", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "bb239edcac49418487695bce2cdd18fd", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "816da93817b84a72a3e9114029a9b252", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "a43c9616cd074cde97c731ddd9e4ceee", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "ee740ebdc9c24ef78eaebb0df6f9a000", "path": "/mitigations/M1017/", "children": []}]}, {"name": "V-X", "id": "1a4bddc3293f4a64884575e0fce7103d", "path": null, "children": [{"name": "Vulnerability Scanning", "id": "f2a4a53579bd4513a7884f74404d1682", "path": "/mitigations/M1016/", "children": []}]}, {"name": "Y-Z", "id": "25d93268bd414d8cb311ee805171c04e", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}]}, "name": "Audit", "descr": "<p>Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</p>", "version": "1.0", "techniques_addressed_data": [{"tid": "T1527", "domain": "Enterprise", "name": "Application Access Token", "descr": "<p>Administrators can set up a variety of logs and leverage audit tools to monitor actions that can be conducted as a result of OAuth 2.0 access. For instance, audit reports enable admins to identify privilege escalation actions such as role creations or policy modifications, which could be actions performed after initial access.</p>"}, {"tid": "T1176", "domain": "Enterprise", "name": "Browser Extensions", "descr": "<p>Ensure extensions that are installed are the intended ones as many malicious extensions will masquerade as legitimate ones.</p>"}, {"tid": "T1088", "domain": "Enterprise", "name": "Bypass User Account Control", "descr": "<p>Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.</p>"}, {"tid": "T1081", "domain": "Enterprise", "name": "Credentials in Files", "descr": "<p>Preemptively search for files containing passwords and take actions to reduce the exposure risk when found.</p>"}, {"tid": "T1214", "domain": "Enterprise", "name": "Credentials in Registry", "descr": "<p>Proactively search for credentials within the Registry and attempt to remediate the risk.</p>"}, {"tid": "T1530", "domain": "Enterprise", "name": "Data from Cloud Storage Object", "descr": "<p>Frequently check permissions on cloud storage to ensure proper permissions are set to deny open or unprivileged access to resources.</p>"}, {"tid": "T1213", "domain": "Enterprise", "name": "Data from Information Repositories", "descr": "<p>Consider periodic review of accounts and privileges for critical and sensitive repositories.</p>"}, {"tid": "T1038", "domain": "Enterprise", "name": "DLL Search Order Hijacking", "descr": "<p>Use auditing tools capable of detecting DLL search order hijacking opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for DLL hijacking weaknesses.<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"Powersploit\"><sup><a href=\"https://github.com/mattifestation/PowerSploit\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}, {"tid": "T1073", "domain": "Enterprise", "name": "DLL Side-Loading", "descr": "<p>Use the program sxstrace.exe that is included with Windows along with manual inspection to check manifest files for side-loading vulnerabilities in software.</p>"}, {"tid": "T1482", "domain": "Enterprise", "name": "Domain Trust Discovery", "descr": "<p>Map the trusts within existing domains/forests and keep trust relationships to a minimum.</p>"}, {"tid": "T1114", "domain": "Enterprise", "name": "Email Collection", "descr": "<p>Enterprise email solutions have monitoring mechanisms that may include the ability to audit auto-forwarding rules on a regular basis.</p><p>In an Exchange environment, Administrators can use Get-InboxRule to discover and remove potentially malicious auto-forwarding rules.<span onclick=scrollToRef('scite-6') id=\"scite-ref-6-a\" class=\"scite-citeref-number\" data-reference=\"TIMMCMIC, 2014\"><sup><a href=\"https://blogs.technet.microsoft.com/timmcmic/2014/07/28/exchange-and-office-365-mail-forwarding/\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p>"}, {"tid": "T1044", "domain": "Enterprise", "name": "File System Permissions Weakness", "descr": "<p>Use auditing tools capable of detecting file system permissions abuse opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for service file system permissions weaknesses.<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"Powersploit\"><sup><a href=\"https://github.com/mattifestation/PowerSploit\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}, {"tid": "T1484", "domain": "Enterprise", "name": "Group Policy Modification", "descr": "<p>Identify and correct GPO permissions abuse opportunities (ex: GPO modification privileges) using auditing tools such as Bloodhound (version 1.5.1 and later).<span onclick=scrollToRef('scite-5') id=\"scite-ref-5-a\" class=\"scite-citeref-number\" data-reference=\"GitHub Bloodhound\"><sup><a href=\"https://github.com/BloodHoundAD/BloodHound\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>"}, {"tid": "T1525", "domain": "Enterprise", "name": "Implant Container Image", "descr": "<p>Periodically check the integrity of images and containers used in cloud deployments to ensure they have not been modified to include malicious software.</p>"}, {"tid": "T1161", "domain": "Enterprise", "name": "LC_LOAD_DYLIB Addition", "descr": "<p>Binaries can also be baselined for what dynamic libraries they require, and if an app requires a new dynamic library that wasn\\u2019t included as part of an update, it should be investigated.</p>"}, {"tid": "T1031", "domain": "Enterprise", "name": "Modify Existing Service", "descr": "<p>Use auditing tools capable of detecting privilege and service abuse opportunities on systems within an enterprise and correct them.</p>"}, {"tid": "T1034", "domain": "Enterprise", "name": "Path Interception", "descr": "<p>Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate. </p><p>Clean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.<span onclick=scrollToRef('scite-2') id=\"scite-ref-2-a\" class=\"scite-citeref-number\" data-reference=\"Microsoft CreateProcess\"><sup><a href=\"http://msdn.microsoft.com/en-us/library/ms682425\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span><span onclick=scrollToRef('scite-3') id=\"scite-ref-3-a\" class=\"scite-citeref-number\" data-reference=\"MSDN DLL Security\"><sup><a href=\"https://msdn.microsoft.com/en-us/library/ff919712.aspx\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span><span onclick=scrollToRef('scite-4') id=\"scite-ref-4-a\" class=\"scite-citeref-number\" data-reference=\"Kanthak Sentinel\"><sup><a href=\"https://skanthak.homepage.t-online.de/sentinel.html\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>"}, {"tid": "T1145", "domain": "Enterprise", "name": "Private Keys", "descr": "<p>Ensure only authorized keys are allowed access to critical resources and audit access lists regularly.</p>"}, {"tid": "T1076", "domain": "Enterprise", "name": "Remote Desktop Protocol", "descr": "<p>Audit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups</p>"}, {"tid": "T1053", "domain": "Enterprise", "name": "Scheduled Task", "descr": "<p>Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"Powersploit\"><sup><a href=\"https://github.com/mattifestation/PowerSploit\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}, {"tid": "T1505", "domain": "Enterprise", "name": "Server Software Component", "descr": "<p>Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made.</p>"}, {"tid": "T1528", "domain": "Enterprise", "name": "Steal Application Access Token", "descr": "<p>Administrators should perform an audit of all OAuth applications and the permissions they have been granted to access organizational data. This should be done extensively on all applications in order to establish a baseline, followed up on with periodic audits of new or updated applications. Suspicious applications should be investigated and removed.</p>"}, {"tid": "T1078", "domain": "Enterprise", "name": "Valid Accounts", "descr": "<p>Routinely audit source code, application configuration files, open repositories, and public cloud storage for insecure use and storage of credentials.</p>"}], "bottom_ref": [{"description": "PowerSploit. (n.d.). Retrieved December 4, 2014.", "url": "https://github.com/mattifestation/PowerSploit", "sname": "Powersploit", "number": 1}, {"description": "Microsoft. (n.d.). CreateProcess function. Retrieved December 5, 2014.", "url": "http://msdn.microsoft.com/en-us/library/ms682425", "sname": "Microsoft CreateProcess", "number": 2}, {"description": "Microsoft. (n.d.). Dynamic-Link Library Security. Retrieved July 25, 2016.", "url": "https://msdn.microsoft.com/en-us/library/ff919712.aspx", "sname": "MSDN DLL Security", "number": 3}, {"description": "Kanthak, S. (2016, July 20). Vulnerability and Exploit Detector. Retrieved February 3, 2017.", "url": "https://skanthak.homepage.t-online.de/sentinel.html", "sname": "Kanthak Sentinel", "number": 4}, {"description": "Robbins, A., Vazarkar, R., and Schroeder, W. (2016, April 17). Bloodhound: Six Degrees of Domain Admin. Retrieved March 5, 2019.", "url": "https://github.com/BloodHoundAD/BloodHound", "sname": "GitHub Bloodhound", "number": 5}, {"description": "Search Results Web Result with Site Links Tim McMichael. (2014, July 28). Exchange and Office 365: Mail Forwarding. Retrieved August 27, 2019.", "url": "https://blogs.technet.microsoft.com/timmcmic/2014/07/28/exchange-and-office-365-mail-forwarding/", "sname": "TIMMCMIC, 2014", "number": 6}]}