Title: Operating System Configuration-enterprise
Template: mitigations/mitigation
save_as: mitigations/M1028/index.html
data: {"attack_id": "M1028", "domain": "enterprise", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/enterprise/", "children": [{"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "Behavior Prevention on Endpoint", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "Credential Access Protection", "path": "/mitigations/M1043/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M1053/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "Environment Variable Permissions", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M1037/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "Limit Software Installation", "path": "/mitigations/M1033/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M1028/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M1027/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "Privileged Process Integrity", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "Remote Data Storage", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M1021/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "User Account Control", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M1017/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M1016/", "children": []}]}, "side_menu_mobile_view_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/enterprise/", "children": [{"name": "A-C", "id": "512df49fe07448598eb675274b08bbb3", "path": null, "children": [{"name": "Account Use Policies", "id": "73c761167c984f1189a674ca42878893", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "9a77cc54cd41443a8b2e90f852b97ea9", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "3b7dafbfe48b4b5aa8e46de1ca5773df", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "459e1913ea284623aebae274565327a5", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "c01b115df44c455ca1c33b82ee80007f", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "8280d591a48d442da10f0c0621abe8b4", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "07521c4d864c4f9fb9f9256377bada45", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "e65add858d0b4929b4ef141825759bc3", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "d4d78ee5fa714998a4bcc5bc29d39303", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "3a4b6639c22942ada8c945b708ad1661", "path": "/mitigations/M1043/", "children": []}]}, {"name": "D-F", "id": "3d388340b6c9425dac15d51e5a31c70e", "path": null, "children": [{"name": "Data Backup", "id": "7b20f13e998d47adb5e095bf35b915be", "path": "/mitigations/M1053/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "2fe930c90d5b483783dc036cf8e64e39", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "8235ee3a46b74feda1e9491e3a2e7d9c", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "cb69b4db3de947a8b08e48990aab7bae", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "07497cf4782144319466c8dbed1509b2", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "bb6e4085281149c0940fb78c31d21c81", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "6763aa47ef3244279d215595d33b6943", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "7b9ba899f0504b4e9b38b3997cb90acb", "path": "/mitigations/M1037/", "children": []}]}, {"name": "G-I", "id": "94e00630ebea47c5860dab32f8d7d503", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}, {"name": "J-L", "id": "42264753851f4b098250fc6ac6f92364", "path": null, "children": [{"name": "Limit Access to Resource Over Network", "id": "2d0fe285de7f47259617e7ec5b415fc1", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "46a2a99bb52149519d063d8891345471", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "16dbf953736e4753bb077e5d88dce768", "path": "/mitigations/M1033/", "children": []}]}, {"name": "M-O", "id": "123a56516d6341c3934634153896df86", "path": null, "children": [{"name": "Multi-factor Authentication", "id": "8ad64a6f4a8a4ff681280ea9fd217854", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "f09a68bd759e455dbe397112fd26a881", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "33b23beb0cf24e7894f9117c2267f401", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "0f929aa201fd4a56a9a7d6fd5a8b733b", "path": "/mitigations/M1028/", "children": []}]}, {"name": "P-R", "id": "b6eea37d43d64f339e2b03386d0aeb59", "path": null, "children": [{"name": "Password Policies", "id": "ba14a663205448abb799d509381c25cf", "path": "/mitigations/M1027/", "children": []}, {"name": "Privileged Account Management", "id": "7227b0d583334f219a1053435b09898d", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "46381f3cc3ae48538c8a0eccf1898b9f", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "f3c59046d2b044c8830c855225ab4aac", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "6fc1145a86f049068e49f2c89325547e", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "b5aa080cb48c49f9a8dd777676f90ddc", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "d83a1909434b4ee7ab8b0a71445f07db", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "28b5148ef0484d5a8556aa7a7f3fd45c", "path": "/mitigations/M1021/", "children": []}]}, {"name": "S-U", "id": "9258e462256d4412a50167078f712663", "path": null, "children": [{"name": "Software Configuration", "id": "11fda1b090344084b8a1605c250cfc0e", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "4203dbe83cea492ba17677c1ba9091b9", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "5f8512ea58ff4c1c9224e3a1b06a33b3", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "bb239edcac49418487695bce2cdd18fd", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "816da93817b84a72a3e9114029a9b252", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "a43c9616cd074cde97c731ddd9e4ceee", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "ee740ebdc9c24ef78eaebb0df6f9a000", "path": "/mitigations/M1017/", "children": []}]}, {"name": "V-X", "id": "1a4bddc3293f4a64884575e0fce7103d", "path": null, "children": [{"name": "Vulnerability Scanning", "id": "f2a4a53579bd4513a7884f74404d1682", "path": "/mitigations/M1016/", "children": []}]}, {"name": "Y-Z", "id": "25d93268bd414d8cb311ee805171c04e", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}]}, "name": "Operating System Configuration", "descr": "<p>Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</p>", "version": "1.0", "techniques_addressed_data": [{"tid": "T1015", "domain": "Enterprise", "name": "Accessibility Features", "descr": "<p>To use this technique remotely, an adversary must use it in conjunction with RDP. Ensure that Network Level Authentication is enabled to force the remote desktop session to authenticate before the session is created and the login screen displayed. It is enabled by default on Windows Vista and later.<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"TechNet RDP NLA\"><sup><a href=\"https://technet.microsoft.com/en-us/library/cc732713.aspx\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}, {"tid": "T1087", "domain": "Enterprise", "name": "Account Discovery", "descr": "<p>Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located <code>HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration &gt; [Policies] &gt; Administrative Templates &gt; Windows Components &gt; Credential User Interface: E numerate administrator accounts on elevation.<span onclick=scrollToRef('scite-2') id=\"scite-ref-2-a\" class=\"scite-citeref-number\" data-reference=\"UCF STIG Elevation Account Enumeration\"><sup><a href=\"https://www.stigviewer.com/stig/microsoft_windows_server_2012_member_server/2013-07-25/finding/WN12-CC-000077\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p>"}, {"tid": "T1098", "domain": "Enterprise", "name": "Account Manipulation", "descr": "<p>Protect domain controllers by ensuring proper security configuration for critical servers to limit access by potentially unnecessary protocols and services, such as SMB file sharing.</p>"}, {"tid": "T1139", "domain": "Enterprise", "name": "Bash History", "descr": "<p>There are multiple methods of preventing a user's command history from being flushed to their .bash_history file, including use of the following commands:<code>set +o history</code> and <code>set -o history</code> to start logging again;<code>unset HISTFILE</code> being added to a user's .bash_rc file; and<code>ln -s /dev/null ~/.bash_history</code> to write commands to <code>/dev/null</code>instead.</p>"}, {"tid": "T1197", "domain": "Enterprise", "name": "BITS Jobs", "descr": "<p>Consider reducing the default BITS job lifetime in Group Policy or by editing the <code>JobInactivityTimeout</code> and <code>MaxDownloadTime</code> Registry values in <code> HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\BITS</code>.<span onclick=scrollToRef('scite-3') id=\"scite-ref-3-a\" class=\"scite-citeref-number\" data-reference=\"Microsoft BITS\"><sup><a href=\"https://msdn.microsoft.com/library/windows/desktop/bb968799.aspx\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p>"}, {"tid": "T1092", "domain": "Enterprise", "name": "Communication Through Removable Media", "descr": "<p>Disallow or restrict removable media at an organizational policy level if they are not required for business operations.</p>"}, {"tid": "T1136", "domain": "Enterprise", "name": "Create Account", "descr": "<p>Protect domain controllers by ensuring proper security configuration for critical servers.</p>"}, {"tid": "T1003", "domain": "Enterprise", "name": "Credential Dumping", "descr": "<p>Consider disabling or restricting NTLM.<span onclick=scrollToRef('scite-5') id=\"scite-ref-5-a\" class=\"scite-citeref-number\" data-reference=\"Microsoft Disable NTLM Nov 2012\"><sup><a href=\"https://technet.microsoft.com/library/jj865668.aspx\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p>"}, {"tid": "T1011", "domain": "Enterprise", "name": "Exfiltration Over Other Network Medium", "descr": "<p>Prevent the creation of new network adapters where possible.</p>"}, {"tid": "T1147", "domain": "Enterprise", "name": "Hidden Users", "descr": "<p>If the computer is domain joined, then group policy can help restrict the ability to create or hide users. Similarly, preventing the modification of the <code>/Library/Preferences/com.apple.loginwindow</code> <code>Hide500Users</code> value will force all users to be visible.</p>"}, {"tid": "T1148", "domain": "Enterprise", "name": "HISTCONTROL", "descr": "<p>Make sure that the <code>HISTCONTROL</code> environment variable is set to \"ignoredup\" instead of \"ignoreboth\" or \"ignorespace\".</p>"}, {"tid": "T1490", "domain": "Enterprise", "name": "Inhibit System Recovery", "descr": "<p>Consider technical controls to prevent the disabling of services or deletion of files involved in system recovery. </p>"}, {"tid": "T1130", "domain": "Enterprise", "name": "Install Root Certificate", "descr": "<p>Windows Group Policy can be used to manage root certificates and the <code>Flags</code> value of <code>HKLM\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\ProtectedRoots</code> can be set to 1 to prevent non-administrator users from making further root installations into their own HKCU certificate store.<span onclick=scrollToRef('scite-6') id=\"scite-ref-6-a\" class=\"scite-citeref-number\" data-reference=\"SpectorOps Code Signing Dec 2017\"><sup><a href=\"https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p>"}, {"tid": "T1174", "domain": "Enterprise", "name": "Password Filter DLL", "descr": "<p>Ensure only valid password filters are registered. Filter DLLs must be present in Windows installation directory (<code>C:\\Windows\\System32\\</code> by default) of a domain controller and/or local computer with a corresponding entry in <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages</code>.</p>"}, {"tid": "T1076", "domain": "Enterprise", "name": "Remote Desktop Protocol", "descr": "<p>Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.<span onclick=scrollToRef('scite-4') id=\"scite-ref-4-a\" class=\"scite-citeref-number\" data-reference=\"Windows RDP Sessions\"><sup><a href=\"https://technet.microsoft.com/en-us/library/cc754272(v=ws.11).aspx\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span></p>"}, {"tid": "T1053", "domain": "Enterprise", "name": "Scheduled Task", "descr": "<p>Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration &gt; [Policies] &gt; Windows Settings &gt; Security Settings &gt; Local Policies &gt; Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.<span onclick=scrollToRef('scite-7') id=\"scite-ref-7-a\" class=\"scite-citeref-number\" data-reference=\"TechNet Server Operator Scheduled Task\"><sup><a href=\"https://technet.microsoft.com/library/jj852168.aspx\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span></p>"}, {"tid": "T1166", "domain": "Enterprise", "name": "Setuid and Setgid", "descr": "<p>Applications with known vulnerabilities or known shell escapes should not have the setuid or setgid bits set to reduce potential damage if an application is compromised. Additionally, the number of programs with setuid or setgid bits set should be minimized across a system.</p>"}, {"tid": "T1206", "domain": "Enterprise", "name": "Sudo Caching", "descr": "<p>Similarly, ensuring that the <code>tty_tickets</code> setting is enabled will prevent this leakage across tty sessions.</p>"}], "bottom_ref": [{"description": "Microsoft. (n.d.). Configure Network Level Authentication for Remote Desktop Services Connections. Retrieved June 6, 2016.", "url": "https://technet.microsoft.com/en-us/library/cc732713.aspx", "sname": "TechNet RDP NLA", "number": 1}, {"description": "UCF. (n.d.). The system must require username and password to elevate a running application.. Retrieved December 18, 2017.", "url": "https://www.stigviewer.com/stig/microsoft_windows_server_2012_member_server/2013-07-25/finding/WN12-CC-000077", "sname": "UCF STIG Elevation Account Enumeration", "number": 2}, {"description": "Microsoft. (n.d.). Background Intelligent Transfer Service. Retrieved January 12, 2018.", "url": "https://msdn.microsoft.com/library/windows/desktop/bb968799.aspx", "sname": "Microsoft BITS", "number": 3}, {"description": "Microsoft. (n.d.). Configure Timeout and Reconnection Settings for Remote Desktop Services Sessions. Retrieved December 11, 2017.", "url": "https://technet.microsoft.com/en-us/library/cc754272(v=ws.11).aspx", "sname": "Windows RDP Sessions", "number": 4}, {"description": "Microsoft. (2012, November 29). Using security policies to restrict NTLM traffic. Retrieved December 4, 2017.", "url": "https://technet.microsoft.com/library/jj865668.aspx", "sname": "Microsoft Disable NTLM Nov 2012", "number": 5}, {"description": "Graeber, M. (2017, December 22). Code Signing Certificate Cloning Attacks and Defenses. Retrieved April 3, 2018.", "url": "https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec", "sname": "SpectorOps Code Signing Dec 2017", "number": 6}, {"description": "Microsoft. (2012, November 15). Domain controller: Allow server operators to schedule tasks. Retrieved December 18, 2017.", "url": "https://technet.microsoft.com/library/jj852168.aspx", "sname": "TechNet Server Operator Scheduled Task", "number": 7}]}