Title: Restrict File and Directory Permissions-enterprise
Template: mitigations/mitigation
save_as: mitigations/M1022/index.html
data: {"attack_id": "M1022", "domain": "enterprise", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/enterprise/", "children": [{"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "Behavior Prevention on Endpoint", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "Credential Access Protection", "path": "/mitigations/M1043/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M1053/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "Environment Variable Permissions", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M1037/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "Limit Software Installation", "path": "/mitigations/M1033/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M1028/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M1027/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "Privileged Process Integrity", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "Remote Data Storage", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M1021/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "User Account Control", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M1017/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M1016/", "children": []}]}, "side_menu_mobile_view_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/enterprise/", "children": [{"name": "A-C", "id": "512df49fe07448598eb675274b08bbb3", "path": null, "children": [{"name": "Account Use Policies", "id": "73c761167c984f1189a674ca42878893", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "9a77cc54cd41443a8b2e90f852b97ea9", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "3b7dafbfe48b4b5aa8e46de1ca5773df", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "459e1913ea284623aebae274565327a5", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "c01b115df44c455ca1c33b82ee80007f", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "8280d591a48d442da10f0c0621abe8b4", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "07521c4d864c4f9fb9f9256377bada45", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "e65add858d0b4929b4ef141825759bc3", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "d4d78ee5fa714998a4bcc5bc29d39303", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "3a4b6639c22942ada8c945b708ad1661", "path": "/mitigations/M1043/", "children": []}]}, {"name": "D-F", "id": "3d388340b6c9425dac15d51e5a31c70e", "path": null, "children": [{"name": "Data Backup", "id": "7b20f13e998d47adb5e095bf35b915be", "path": "/mitigations/M1053/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "2fe930c90d5b483783dc036cf8e64e39", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "8235ee3a46b74feda1e9491e3a2e7d9c", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "cb69b4db3de947a8b08e48990aab7bae", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "07497cf4782144319466c8dbed1509b2", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "bb6e4085281149c0940fb78c31d21c81", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "6763aa47ef3244279d215595d33b6943", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "7b9ba899f0504b4e9b38b3997cb90acb", "path": "/mitigations/M1037/", "children": []}]}, {"name": "G-I", "id": "94e00630ebea47c5860dab32f8d7d503", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}, {"name": "J-L", "id": "42264753851f4b098250fc6ac6f92364", "path": null, "children": [{"name": "Limit Access to Resource Over Network", "id": "2d0fe285de7f47259617e7ec5b415fc1", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "46a2a99bb52149519d063d8891345471", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "16dbf953736e4753bb077e5d88dce768", "path": "/mitigations/M1033/", "children": []}]}, {"name": "M-O", "id": "123a56516d6341c3934634153896df86", "path": null, "children": [{"name": "Multi-factor Authentication", "id": "8ad64a6f4a8a4ff681280ea9fd217854", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "f09a68bd759e455dbe397112fd26a881", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "33b23beb0cf24e7894f9117c2267f401", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "0f929aa201fd4a56a9a7d6fd5a8b733b", "path": "/mitigations/M1028/", "children": []}]}, {"name": "P-R", "id": "b6eea37d43d64f339e2b03386d0aeb59", "path": null, "children": [{"name": "Password Policies", "id": "ba14a663205448abb799d509381c25cf", "path": "/mitigations/M1027/", "children": []}, {"name": "Privileged Account Management", "id": "7227b0d583334f219a1053435b09898d", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "46381f3cc3ae48538c8a0eccf1898b9f", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "f3c59046d2b044c8830c855225ab4aac", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "6fc1145a86f049068e49f2c89325547e", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "b5aa080cb48c49f9a8dd777676f90ddc", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "d83a1909434b4ee7ab8b0a71445f07db", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "28b5148ef0484d5a8556aa7a7f3fd45c", "path": "/mitigations/M1021/", "children": []}]}, {"name": "S-U", "id": "9258e462256d4412a50167078f712663", "path": null, "children": [{"name": "Software Configuration", "id": "11fda1b090344084b8a1605c250cfc0e", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "4203dbe83cea492ba17677c1ba9091b9", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "5f8512ea58ff4c1c9224e3a1b06a33b3", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "bb239edcac49418487695bce2cdd18fd", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "816da93817b84a72a3e9114029a9b252", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "a43c9616cd074cde97c731ddd9e4ceee", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "ee740ebdc9c24ef78eaebb0df6f9a000", "path": "/mitigations/M1017/", "children": []}]}, {"name": "V-X", "id": "1a4bddc3293f4a64884575e0fce7103d", "path": null, "children": [{"name": "Vulnerability Scanning", "id": "f2a4a53579bd4513a7884f74404d1682", "path": "/mitigations/M1016/", "children": []}]}, {"name": "Y-Z", "id": "25d93268bd414d8cb311ee805171c04e", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}]}, "name": "Restrict File and Directory Permissions", "descr": "<p>Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</p>", "version": "1.0", "techniques_addressed_data": [{"tid": "T1156", "domain": "Enterprise", "name": ".bash_profile and .bashrc", "descr": "<p>Making these files immutable and only changeable by certain administrators will limit the ability for adversaries to easily create user level persistence.</p>"}, {"tid": "T1146", "domain": "Enterprise", "name": "Clear Command History", "descr": "<p>Preventing users from deleting or writing to certain files can stop adversaries from maliciously altering their <code>~/.bash_history</code> files.</p>"}, {"tid": "T1196", "domain": "Enterprise", "name": "Control Panel Items", "descr": "<p>Restrict storage and execution of Control Panel items to protected directories, such as <code>C:\\Windows</code>, rather than user directories.</p>"}, {"tid": "T1081", "domain": "Enterprise", "name": "Credentials in Files", "descr": "<p>Restrict file shares to specific directories with access only to necessary users.</p>"}, {"tid": "T1530", "domain": "Enterprise", "name": "Data from Cloud Storage Object", "descr": "<p>Use access control lists on storage systems and objects.</p>"}, {"tid": "T1089", "domain": "Enterprise", "name": "Disabling Security Tools", "descr": "<p>Ensure proper process, Registry, and file permissions are in place to prevent adversaries from disabling or interfering with security services.</p>"}, {"tid": "T1073", "domain": "Enterprise", "name": "DLL Side-Loading", "descr": "<p>Install software in write-protected locations.</p>"}, {"tid": "T1157", "domain": "Enterprise", "name": "Dylib Hijacking", "descr": "<p>Set directory access controls to prevent file writes to the search paths for applications, both in the folders where applications are run from and the standard dylib folders.</p>"}, {"tid": "T1054", "domain": "Enterprise", "name": "Indicator Blocking", "descr": "<p>Ensure event tracers/forwarders, firewall policies, and other associated mechanisms are secured with appropriate permissions and access controls.<span onclick=scrollToRef('scite-2') id=\"scite-ref-2-a\" class=\"scite-citeref-number\" data-reference=\"Microsoft ETW May 2018\"><sup><a href=\"https://docs.microsoft.com/windows/desktop/etw/event-tracing-portal\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p>"}, {"tid": "T1070", "domain": "Enterprise", "name": "Indicator Removal on Host", "descr": "<p>Protect generated event files that are stored locally with proper permissions and authentication and limit opportunities for adversaries to increase privileges by preventing Privilege Escalation opportunities.</p>"}, {"tid": "T1037", "domain": "Enterprise", "name": "Logon Scripts", "descr": "<p>Restrict write access to logon scripts to specific administrators.</p>"}, {"tid": "T1036", "domain": "Enterprise", "name": "Masquerading", "descr": "<p>Use file system access controls to protect folders such as C:\\Windows\\System32.</p>"}, {"tid": "T1096", "domain": "Enterprise", "name": "NTFS File Attributes", "descr": "<p>Consider adjusting read and write permissions for NTFS EA, though this should be tested to ensure routine OS operations are not impeded.</p>"}, {"tid": "T1034", "domain": "Enterprise", "name": "Path Interception", "descr": "<p>Require that all executables be placed in write-protected directories.</p>"}, {"tid": "T1150", "domain": "Enterprise", "name": "Plist Modification", "descr": "<p>Prevent plist files from being modified by users by making them read-only.</p>"}, {"tid": "T1504", "domain": "Enterprise", "name": "PowerShell Profile", "descr": "<p>Making PowerShell profiles immutable and only changeable by certain administrators will limit the ability for adversaries to easily create user level persistence.</p>"}, {"tid": "T1145", "domain": "Enterprise", "name": "Private Keys", "descr": "<p>Ensure permissions are properly set on folders containing sensitive private keys to prevent unintended access.</p>"}, {"tid": "T1494", "domain": "Enterprise", "name": "Runtime Data Manipulation", "descr": "<p>Prevent critical business and system processes from being replaced, overwritten, or reconfigured to load potentially malicious code.</p>"}, {"tid": "T1035", "domain": "Enterprise", "name": "Service Execution", "descr": "<p>Also ensure that high permission level service binaries cannot be replaced or modified by users with a lower permission level.</p>"}, {"tid": "T1489", "domain": "Enterprise", "name": "Service Stop", "descr": "<p>Ensure proper process and file permissions are in place to inhibit adversaries from disabling or interfering with critical services.</p>"}, {"tid": "T1051", "domain": "Enterprise", "name": "Shared Webroot", "descr": "<p>Disable execution on directories within the webroot. Ensure proper permissions on directories that are accessible through a Web server.</p>"}, {"tid": "T1198", "domain": "Enterprise", "name": "SIP and Trust Provider Hijacking", "descr": "<p>Restrict storage and execution of SIP DLLs to protected directories, such as C:\\Windows, rather than user directories.</p>"}, {"tid": "T1184", "domain": "Enterprise", "name": "SSH Hijacking", "descr": "<p>Ensure proper file permissions are set and harden system to prevent root privilege escalation opportunities.</p>"}, {"tid": "T1165", "domain": "Enterprise", "name": "Startup Items", "descr": "<p>Since StartupItems are deprecated, preventing all users from writing to the <code>/Library/StartupItems</code> directory would prevent any startup items from getting registered.</p>"}, {"tid": "T1492", "domain": "Enterprise", "name": "Stored Data Manipulation", "descr": "<p>Ensure least privilege principles are applied to important information resources to reduce exposure to data manipulation risk.</p>"}, {"tid": "T1169", "domain": "Enterprise", "name": "Sudo", "descr": "<p>The sudoers file should be strictly edited such that passwords are always required and that users can't spawn risky processes as users with higher privilege.</p>"}, {"tid": "T1501", "domain": "Enterprise", "name": "Systemd Service", "descr": "<p>Restrict read/write access to systemd unit files to only select privileged users who have a legitimate need to manage system services.</p>"}, {"tid": "T1080", "domain": "Enterprise", "name": "Taint Shared Content", "descr": "<p>Protect shared folders by minimizing users who have write access.</p>"}, {"tid": "T1209", "domain": "Enterprise", "name": "Time Providers", "descr": "<p>Consider using Group Policy to configure and block additions/modifications to W32Time DLLs.<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"Microsoft W32Time May 2017\"><sup><a href=\"https://docs.microsoft.com/windows-server/networking/windows-time-service/windows-time-service-tools-and-settings\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}], "bottom_ref": [{"description": "Mathers, B. (2017, May 31). Windows Time Service Tools and Settings. Retrieved March 26, 2018.", "url": "https://docs.microsoft.com/windows-server/networking/windows-time-service/windows-time-service-tools-and-settings", "sname": "Microsoft W32Time May 2017", "number": 1}, {"description": "Microsoft. (2018, May 30). Event Tracing. Retrieved September 6, 2018.", "url": "https://docs.microsoft.com/windows/desktop/etw/event-tracing-portal", "sname": "Microsoft ETW May 2018", "number": 2}]}