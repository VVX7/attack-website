Title: Network Segmentation-enterprise
Template: mitigations/mitigation
save_as: mitigations/M1030/index.html
data: {"attack_id": "M1030", "domain": "enterprise", "side_menu_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/enterprise/", "children": [{"name": "Account Use Policies", "id": "Account Use Policies", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "Active Directory Configuration", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "Antivirus/Antimalware", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "Application Developer Guidance", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "Application Isolation and Sandboxing", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "Audit", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "Behavior Prevention on Endpoint", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "Boot Integrity", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "Code Signing", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "Credential Access Protection", "path": "/mitigations/M1043/", "children": []}, {"name": "Data Backup", "id": "Data Backup", "path": "/mitigations/M1053/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "Disable or Remove Feature or Program", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "Do Not Mitigate", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "Encrypt Sensitive Information", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "Environment Variable Permissions", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "Execution Prevention", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "Exploit Protection", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "Filter Network Traffic", "path": "/mitigations/M1037/", "children": []}, {"name": "Limit Access to Resource Over Network", "id": "Limit Access to Resource Over Network", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "Limit Hardware Installation", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "Limit Software Installation", "path": "/mitigations/M1033/", "children": []}, {"name": "Multi-factor Authentication", "id": "Multi-factor Authentication", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "Network Intrusion Prevention", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "Network Segmentation", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "Operating System Configuration", "path": "/mitigations/M1028/", "children": []}, {"name": "Password Policies", "id": "Password Policies", "path": "/mitigations/M1027/", "children": []}, {"name": "Privileged Account Management", "id": "Privileged Account Management", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "Privileged Process Integrity", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "Remote Data Storage", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "Restrict File and Directory Permissions", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "Restrict Library Loading", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "Restrict Registry Permissions", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "Restrict Web-Based Content", "path": "/mitigations/M1021/", "children": []}, {"name": "Software Configuration", "id": "Software Configuration", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "SSL/TLS Inspection", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "Threat Intelligence Program", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "Update Software", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "User Account Control", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "User Account Management", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "User Training", "path": "/mitigations/M1017/", "children": []}, {"name": "Vulnerability Scanning", "id": "Vulnerability Scanning", "path": "/mitigations/M1016/", "children": []}]}, "side_menu_mobile_view_data": {"name": "mitigations", "id": "mitigations", "path": "/mitigations/enterprise/", "children": [{"name": "A-C", "id": "512df49fe07448598eb675274b08bbb3", "path": null, "children": [{"name": "Account Use Policies", "id": "73c761167c984f1189a674ca42878893", "path": "/mitigations/M1036/", "children": []}, {"name": "Active Directory Configuration", "id": "9a77cc54cd41443a8b2e90f852b97ea9", "path": "/mitigations/M1015/", "children": []}, {"name": "Antivirus/Antimalware", "id": "3b7dafbfe48b4b5aa8e46de1ca5773df", "path": "/mitigations/M1049/", "children": []}, {"name": "Application Developer Guidance", "id": "459e1913ea284623aebae274565327a5", "path": "/mitigations/M1013/", "children": []}, {"name": "Application Isolation and Sandboxing", "id": "c01b115df44c455ca1c33b82ee80007f", "path": "/mitigations/M1048/", "children": []}, {"name": "Audit", "id": "8280d591a48d442da10f0c0621abe8b4", "path": "/mitigations/M1047/", "children": []}, {"name": "Behavior Prevention on Endpoint", "id": "07521c4d864c4f9fb9f9256377bada45", "path": "/mitigations/M1040/", "children": []}, {"name": "Boot Integrity", "id": "e65add858d0b4929b4ef141825759bc3", "path": "/mitigations/M1046/", "children": []}, {"name": "Code Signing", "id": "d4d78ee5fa714998a4bcc5bc29d39303", "path": "/mitigations/M1045/", "children": []}, {"name": "Credential Access Protection", "id": "3a4b6639c22942ada8c945b708ad1661", "path": "/mitigations/M1043/", "children": []}]}, {"name": "D-F", "id": "3d388340b6c9425dac15d51e5a31c70e", "path": null, "children": [{"name": "Data Backup", "id": "7b20f13e998d47adb5e095bf35b915be", "path": "/mitigations/M1053/", "children": []}, {"name": "Disable or Remove Feature or Program", "id": "2fe930c90d5b483783dc036cf8e64e39", "path": "/mitigations/M1042/", "children": []}, {"name": "Do Not Mitigate", "id": "8235ee3a46b74feda1e9491e3a2e7d9c", "path": "/mitigations/M1055/", "children": []}, {"name": "Encrypt Sensitive Information", "id": "cb69b4db3de947a8b08e48990aab7bae", "path": "/mitigations/M1041/", "children": []}, {"name": "Environment Variable Permissions", "id": "07497cf4782144319466c8dbed1509b2", "path": "/mitigations/M1039/", "children": []}, {"name": "Execution Prevention", "id": "bb6e4085281149c0940fb78c31d21c81", "path": "/mitigations/M1038/", "children": []}, {"name": "Exploit Protection", "id": "6763aa47ef3244279d215595d33b6943", "path": "/mitigations/M1050/", "children": []}, {"name": "Filter Network Traffic", "id": "7b9ba899f0504b4e9b38b3997cb90acb", "path": "/mitigations/M1037/", "children": []}]}, {"name": "G-I", "id": "94e00630ebea47c5860dab32f8d7d503", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}, {"name": "J-L", "id": "42264753851f4b098250fc6ac6f92364", "path": null, "children": [{"name": "Limit Access to Resource Over Network", "id": "2d0fe285de7f47259617e7ec5b415fc1", "path": "/mitigations/M1035/", "children": []}, {"name": "Limit Hardware Installation", "id": "46a2a99bb52149519d063d8891345471", "path": "/mitigations/M1034/", "children": []}, {"name": "Limit Software Installation", "id": "16dbf953736e4753bb077e5d88dce768", "path": "/mitigations/M1033/", "children": []}]}, {"name": "M-O", "id": "123a56516d6341c3934634153896df86", "path": null, "children": [{"name": "Multi-factor Authentication", "id": "8ad64a6f4a8a4ff681280ea9fd217854", "path": "/mitigations/M1032/", "children": []}, {"name": "Network Intrusion Prevention", "id": "f09a68bd759e455dbe397112fd26a881", "path": "/mitigations/M1031/", "children": []}, {"name": "Network Segmentation", "id": "33b23beb0cf24e7894f9117c2267f401", "path": "/mitigations/M1030/", "children": []}, {"name": "Operating System Configuration", "id": "0f929aa201fd4a56a9a7d6fd5a8b733b", "path": "/mitigations/M1028/", "children": []}]}, {"name": "P-R", "id": "b6eea37d43d64f339e2b03386d0aeb59", "path": null, "children": [{"name": "Password Policies", "id": "ba14a663205448abb799d509381c25cf", "path": "/mitigations/M1027/", "children": []}, {"name": "Privileged Account Management", "id": "7227b0d583334f219a1053435b09898d", "path": "/mitigations/M1026/", "children": []}, {"name": "Privileged Process Integrity", "id": "46381f3cc3ae48538c8a0eccf1898b9f", "path": "/mitigations/M1025/", "children": []}, {"name": "Remote Data Storage", "id": "f3c59046d2b044c8830c855225ab4aac", "path": "/mitigations/M1029/", "children": []}, {"name": "Restrict File and Directory Permissions", "id": "6fc1145a86f049068e49f2c89325547e", "path": "/mitigations/M1022/", "children": []}, {"name": "Restrict Library Loading", "id": "b5aa080cb48c49f9a8dd777676f90ddc", "path": "/mitigations/M1044/", "children": []}, {"name": "Restrict Registry Permissions", "id": "d83a1909434b4ee7ab8b0a71445f07db", "path": "/mitigations/M1024/", "children": []}, {"name": "Restrict Web-Based Content", "id": "28b5148ef0484d5a8556aa7a7f3fd45c", "path": "/mitigations/M1021/", "children": []}]}, {"name": "S-U", "id": "9258e462256d4412a50167078f712663", "path": null, "children": [{"name": "Software Configuration", "id": "11fda1b090344084b8a1605c250cfc0e", "path": "/mitigations/M1054/", "children": []}, {"name": "SSL/TLS Inspection", "id": "4203dbe83cea492ba17677c1ba9091b9", "path": "/mitigations/M1020/", "children": []}, {"name": "Threat Intelligence Program", "id": "5f8512ea58ff4c1c9224e3a1b06a33b3", "path": "/mitigations/M1019/", "children": []}, {"name": "Update Software", "id": "bb239edcac49418487695bce2cdd18fd", "path": "/mitigations/M1051/", "children": []}, {"name": "User Account Control", "id": "816da93817b84a72a3e9114029a9b252", "path": "/mitigations/M1052/", "children": []}, {"name": "User Account Management", "id": "a43c9616cd074cde97c731ddd9e4ceee", "path": "/mitigations/M1018/", "children": []}, {"name": "User Training", "id": "ee740ebdc9c24ef78eaebb0df6f9a000", "path": "/mitigations/M1017/", "children": []}]}, {"name": "V-X", "id": "1a4bddc3293f4a64884575e0fce7103d", "path": null, "children": [{"name": "Vulnerability Scanning", "id": "f2a4a53579bd4513a7884f74404d1682", "path": "/mitigations/M1016/", "children": []}]}, {"name": "Y-Z", "id": "25d93268bd414d8cb311ee805171c04e", "path": null, "children": [{"name": "No mitigations", "id": "empty", "path": null, "children": []}]}]}, "name": "Network Segmentation", "descr": "<p>Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.</p>", "version": "1.0", "techniques_addressed_data": [{"tid": "T1098", "domain": "Enterprise", "name": "Account Manipulation", "descr": "<p>Configure access controls and firewalls to limit access to critical systems and domain controllers. Most cloud environments support separate virtual private cloud (VPC) instances that enable further segmentation of cloud systems.</p>"}, {"tid": "T1017", "domain": "Enterprise", "name": "Application Deployment Software", "descr": "<p>Ensure proper system and access isolation for critical network systems through use of firewalls, account privilege separation, group policy, and multi-factor authentication.</p>"}, {"tid": "T1043", "domain": "Enterprise", "name": "Commonly Used Port", "descr": "<p>Configure internal and external firewalls to block traffic using common ports that associate to network protocols that may be unnecessary for that particular network segment.</p>"}, {"tid": "T1175", "domain": "Enterprise", "name": "Component Object Model and Distributed COM", "descr": "<p>Enable Windows firewall, which prevents DCOM instantiation by default.</p>"}, {"tid": "T1136", "domain": "Enterprise", "name": "Create Account", "descr": "<p>Configure access controls and firewalls to limit access to domain controllers and systems used to create and manage accounts.</p>"}, {"tid": "T1094", "domain": "Enterprise", "name": "Custom Command and Control Protocol", "descr": "<p>Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces.</p>"}, {"tid": "T1482", "domain": "Enterprise", "name": "Domain Trust Discovery", "descr": "<p>Employ network segmentation for sensitive domains..<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"Harmj0y Domain Trusts\"><sup><a href=\"http://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/ \" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p>"}, {"tid": "T1048", "domain": "Enterprise", "name": "Exfiltration Over Alternative Protocol", "descr": "<p>Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.<span onclick=scrollToRef('scite-3') id=\"scite-ref-3-a\" class=\"scite-citeref-number\" data-reference=\"TechNet Firewall Design\"><sup><a href=\"https://technet.microsoft.com/en-us/library/cc700828.aspx\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span></p>"}, {"tid": "T1190", "domain": "Enterprise", "name": "Exploit Public-Facing Application", "descr": "<p>Segment externally facing servers and services from the rest of the network with a DMZ or on separate hosting infrastructure.</p>"}, {"tid": "T1210", "domain": "Enterprise", "name": "Exploitation of Remote Services", "descr": "<p>Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods.</p>"}, {"tid": "T1133", "domain": "Enterprise", "name": "External Remote Services", "descr": "<p>Deny direct remote access to internal systems through the use of network proxies, gateways, and firewalls.</p>"}, {"tid": "T1046", "domain": "Enterprise", "name": "Network Service Scanning", "descr": "<p>Ensure proper network segmentation is followed to protect critical servers and devices.</p>"}, {"tid": "T1145", "domain": "Enterprise", "name": "Private Keys", "descr": "<p>Use separate infrastructure for managing critical systems to prevent overlap of credentials and permissions on systems that could be used as vectors for lateral movement.</p>"}, {"tid": "T1076", "domain": "Enterprise", "name": "Remote Desktop Protocol", "descr": "<p>Do not leave RDP accessible from the internet. Enable firewall rules to block RDP traffic between network security zones within a network.</p>"}, {"tid": "T1494", "domain": "Enterprise", "name": "Runtime Data Manipulation", "descr": "<p>Identify critical business and system processes that may be targeted by adversaries and work to isolate and secure those systems against unauthorized access and tampering. </p>"}, {"tid": "T1489", "domain": "Enterprise", "name": "Service Stop", "descr": "<p>Operate intrusion detection, analysis, and response systems on a separate network from the production environment to lessen the chances that an adversary can see and interfere with critical response functions.</p>"}, {"tid": "T1051", "domain": "Enterprise", "name": "Shared Webroot", "descr": "<p>Networks that allow for open development and testing of Web content and allow users to set up their own Web servers on the enterprise network may be particularly vulnerable if the systems and Web servers are not properly secured to limit unauthenticated network share access and network/system isolation</p>"}, {"tid": "T1095", "domain": "Enterprise", "name": "Standard Non-Application Layer Protocol", "descr": "<p>Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces.</p>"}, {"tid": "T1072", "domain": "Enterprise", "name": "Third-party Software", "descr": "<p>Ensure proper system isolation for critical network systems through use of firewalls.</p>"}, {"tid": "T1199", "domain": "Enterprise", "name": "Trusted Relationship", "descr": "<p>Network segmentation can be used to isolate infrastructure components that do not require broad network access.</p>"}, {"tid": "T1065", "domain": "Enterprise", "name": "Uncommonly Used Port", "descr": "<p>Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports for that particular network segment.</p>"}, {"tid": "T1028", "domain": "Enterprise", "name": "Windows Remote Management", "descr": "<p>If the service is necessary, lock down critical enclaves with separate WinRM infrastructure and follow WinRM best practices on use of host firewalls to restrict WinRM access to allow communication only to/from specific devices.<span onclick=scrollToRef('scite-2') id=\"scite-ref-2-a\" class=\"scite-citeref-number\" data-reference=\"NSA Spotting\"><sup><a href=\"https://www.iad.gov/iad/library/reports/spotting-the-adversary-with-windows-event-log-monitoring.cfm\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span></p>"}], "bottom_ref": [{"description": "Schroeder, W. (2017, October 30). A Guide to Attacking Domain Trusts. Retrieved February 14, 2019.", "url": "http://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/ ", "sname": "Harmj0y Domain Trusts", "number": 1}, {"description": "National Security Agency/Central Security Service Information Assurance Directorate. (2015, August 7). Spotting the Adversary with Windows Event Log Monitoring. Retrieved September 6, 2018.", "url": "https://www.iad.gov/iad/library/reports/spotting-the-adversary-with-windows-event-log-monitoring.cfm", "sname": "NSA Spotting", "number": 2}, {"description": "Microsoft. (2004, February 6). Perimeter Firewall Design. Retrieved April 25, 2016.", "url": "https://technet.microsoft.com/en-us/library/cc700828.aspx", "sname": "TechNet Firewall Design", "number": 3}]}