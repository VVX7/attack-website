Title: URL Scheme Hijacking-['Credential Access']-mobile
Template: techniques/technique
save_as: techniques/T1415/index.html
data: {"attack_id": "T1415", "domain": "mobile", "menu": {"name": "techniques", "id": "techniques", "path": "/techniques/mobile/", "children": [{"name": "Initial Access", "id": "TA0027", "path": "/tactics/TA0027", "children": [{"name": "Deliver Malicious App via Authorized App Store", "id": "T1475", "path": "/techniques/T1475/", "children": []}, {"name": "Deliver Malicious App via Other Means", "id": "T1476", "path": "/techniques/T1476/", "children": []}, {"name": "Drive-by Compromise", "id": "T1456", "path": "/techniques/T1456/", "children": []}, {"name": "Exploit via Charging Station or PC", "id": "T1458", "path": "/techniques/T1458/", "children": []}, {"name": "Exploit via Radio Interfaces", "id": "T1477", "path": "/techniques/T1477/", "children": []}, {"name": "Install Insecure or Malicious Configuration", "id": "T1478", "path": "/techniques/T1478/", "children": []}, {"name": "Lockscreen Bypass", "id": "T1461", "path": "/techniques/T1461/", "children": []}, {"name": "Masquerade as Legitimate Application", "id": "T1444", "path": "/techniques/T1444/", "children": []}, {"name": "Supply Chain Compromise", "id": "T1474", "path": "/techniques/T1474/", "children": []}]}, {"name": "Persistence", "id": "TA0028", "path": "/tactics/TA0028", "children": [{"name": "Abuse Device Administrator Access to Prevent Removal", "id": "T1401", "path": "/techniques/T1401/", "children": []}, {"name": "App Auto-Start at Device Boot", "id": "T1402", "path": "/techniques/T1402/", "children": []}, {"name": "Modify Cached Executable Code", "id": "T1403", "path": "/techniques/T1403/", "children": []}, {"name": "Modify OS Kernel or Boot Partition", "id": "T1398", "path": "/techniques/T1398/", "children": []}, {"name": "Modify System Partition", "id": "T1400", "path": "/techniques/T1400/", "children": []}, {"name": "Modify Trusted Execution Environment", "id": "T1399", "path": "/techniques/T1399/", "children": []}]}, {"name": "Privilege Escalation", "id": "TA0029", "path": "/tactics/TA0029", "children": [{"name": "Exploit OS Vulnerability", "id": "T1404", "path": "/techniques/T1404/", "children": []}, {"name": "Exploit TEE Vulnerability", "id": "T1405", "path": "/techniques/T1405/", "children": []}]}, {"name": "Defense Evasion", "id": "TA0030", "path": "/tactics/TA0030", "children": [{"name": "Abuse Accessibility Features", "id": "T1453", "path": "/techniques/T1453/", "children": []}, {"name": "Application Discovery", "id": "T1418", "path": "/techniques/T1418/", "children": []}, {"name": "Device Lockout", "id": "T1446", "path": "/techniques/T1446/", "children": []}, {"name": "Disguise Root/Jailbreak Indicators", "id": "T1408", "path": "/techniques/T1408/", "children": []}, {"name": "Download New Code at Runtime", "id": "T1407", "path": "/techniques/T1407/", "children": []}, {"name": "Evade Analysis Environment", "id": "T1523", "path": "/techniques/T1523/", "children": []}, {"name": "Input Injection", "id": "T1516", "path": "/techniques/T1516/", "children": []}, {"name": "Install Insecure or Malicious Configuration", "id": "T1478", "path": "/techniques/T1478/", "children": []}, {"name": "Modify OS Kernel or Boot Partition", "id": "T1398", "path": "/techniques/T1398/", "children": []}, {"name": "Modify System Partition", "id": "T1400", "path": "/techniques/T1400/", "children": []}, {"name": "Modify Trusted Execution Environment", "id": "T1399", "path": "/techniques/T1399/", "children": []}, {"name": "Obfuscated Files or Information", "id": "T1406", "path": "/techniques/T1406/", "children": []}, {"name": "Suppress Application Icon", "id": "T1508", "path": "/techniques/T1508/", "children": []}]}, {"name": "Credential Access", "id": "TA0031", "path": "/tactics/TA0031", "children": [{"name": "Abuse Accessibility Features", "id": "T1453", "path": "/techniques/T1453/", "children": []}, {"name": "Access Notifications", "id": "T1517", "path": "/techniques/T1517/", "children": []}, {"name": "Access Sensitive Data in Device Logs", "id": "T1413", "path": "/techniques/T1413/", "children": []}, {"name": "Access Stored Application Data", "id": "T1409", "path": "/techniques/T1409/", "children": []}, {"name": "Android Intent Hijacking", "id": "T1416", "path": "/techniques/T1416/", "children": []}, {"name": "Capture Clipboard Data", "id": "T1414", "path": "/techniques/T1414/", "children": []}, {"name": "Capture SMS Messages", "id": "T1412", "path": "/techniques/T1412/", "children": []}, {"name": "Exploit TEE Vulnerability", "id": "T1405", "path": "/techniques/T1405/", "children": []}, {"name": "Input Capture", "id": "T1417", "path": "/techniques/T1417/", "children": []}, {"name": "Input Prompt", "id": "T1411", "path": "/techniques/T1411/", "children": []}, {"name": "Network Traffic Capture or Redirection", "id": "T1410", "path": "/techniques/T1410/", "children": []}, {"name": "URL Scheme Hijacking", "id": "T1415", "path": "/techniques/T1415/", "children": []}]}, {"name": "Discovery", "id": "TA0032", "path": "/tactics/TA0032", "children": [{"name": "Application Discovery", "id": "T1418", "path": "/techniques/T1418/", "children": []}, {"name": "Evade Analysis Environment", "id": "T1523", "path": "/techniques/T1523/", "children": []}, {"name": "File and Directory Discovery", "id": "T1420", "path": "/techniques/T1420/", "children": []}, {"name": "Location Tracking", "id": "T1430", "path": "/techniques/T1430/", "children": []}, {"name": "Network Service Scanning", "id": "T1423", "path": "/techniques/T1423/", "children": []}, {"name": "Process Discovery", "id": "T1424", "path": "/techniques/T1424/", "children": []}, {"name": "System Information Discovery", "id": "T1426", "path": "/techniques/T1426/", "children": []}, {"name": "System Network Configuration Discovery", "id": "T1422", "path": "/techniques/T1422/", "children": []}, {"name": "System Network Connections Discovery", "id": "T1421", "path": "/techniques/T1421/", "children": []}]}, {"name": "Lateral Movement", "id": "TA0033", "path": "/tactics/TA0033", "children": [{"name": "Attack PC via USB Connection", "id": "T1427", "path": "/techniques/T1427/", "children": []}, {"name": "Exploit Enterprise Resources", "id": "T1428", "path": "/techniques/T1428/", "children": []}]}, {"name": "Impact", "id": "TA0034", "path": "/tactics/TA0034", "children": [{"name": "Abuse Accessibility Features", "id": "T1453", "path": "/techniques/T1453/", "children": []}, {"name": "Clipboard Modification", "id": "T1510", "path": "/techniques/T1510/", "children": []}, {"name": "Data Encrypted for Impact", "id": "T1471", "path": "/techniques/T1471/", "children": []}, {"name": "Delete Device Data", "id": "T1447", "path": "/techniques/T1447/", "children": []}, {"name": "Device Lockout", "id": "T1446", "path": "/techniques/T1446/", "children": []}, {"name": "Generate Fraudulent Advertising Revenue", "id": "T1472", "path": "/techniques/T1472/", "children": []}, {"name": "Input Injection", "id": "T1516", "path": "/techniques/T1516/", "children": []}, {"name": "Manipulate App Store Rankings or Ratings", "id": "T1452", "path": "/techniques/T1452/", "children": []}, {"name": "Modify System Partition", "id": "T1400", "path": "/techniques/T1400/", "children": []}, {"name": "Premium SMS Toll Fraud", "id": "T1448", "path": "/techniques/T1448/", "children": []}]}, {"name": "Collection", "id": "TA0035", "path": "/tactics/TA0035", "children": [{"name": "Abuse Accessibility Features", "id": "T1453", "path": "/techniques/T1453/", "children": []}, {"name": "Access Calendar Entries", "id": "T1435", "path": "/techniques/T1435/", "children": []}, {"name": "Access Call Log", "id": "T1433", "path": "/techniques/T1433/", "children": []}, {"name": "Access Contact List", "id": "T1432", "path": "/techniques/T1432/", "children": []}, {"name": "Access Notifications", "id": "T1517", "path": "/techniques/T1517/", "children": []}, {"name": "Access Sensitive Data in Device Logs", "id": "T1413", "path": "/techniques/T1413/", "children": []}, {"name": "Access Stored Application Data", "id": "T1409", "path": "/techniques/T1409/", "children": []}, {"name": "Capture Audio", "id": "T1429", "path": "/techniques/T1429/", "children": []}, {"name": "Capture Camera", "id": "T1512", "path": "/techniques/T1512/", "children": []}, {"name": "Capture Clipboard Data", "id": "T1414", "path": "/techniques/T1414/", "children": []}, {"name": "Capture SMS Messages", "id": "T1412", "path": "/techniques/T1412/", "children": []}, {"name": "Data from Local System", "id": "T1533", "path": "/techniques/T1533/", "children": []}, {"name": "Input Capture", "id": "T1417", "path": "/techniques/T1417/", "children": []}, {"name": "Location Tracking", "id": "T1430", "path": "/techniques/T1430/", "children": []}, {"name": "Network Information Discovery", "id": "T1507", "path": "/techniques/T1507/", "children": []}, {"name": "Network Traffic Capture or Redirection", "id": "T1410", "path": "/techniques/T1410/", "children": []}, {"name": "Screen Capture", "id": "T1513", "path": "/techniques/T1513/", "children": []}]}, {"name": "Exfiltration", "id": "TA0036", "path": "/tactics/TA0036", "children": [{"name": "Alternate Network Mediums", "id": "T1438", "path": "/techniques/T1438/", "children": []}, {"name": "Commonly Used Port", "id": "T1436", "path": "/techniques/T1436/", "children": []}, {"name": "Data Encrypted", "id": "T1532", "path": "/techniques/T1532/", "children": []}, {"name": "Standard Application Layer Protocol", "id": "T1437", "path": "/techniques/T1437/", "children": []}]}, {"name": "Command and Control", "id": "TA0037", "path": "/tactics/TA0037", "children": [{"name": "Alternate Network Mediums", "id": "T1438", "path": "/techniques/T1438/", "children": []}, {"name": "Commonly Used Port", "id": "T1436", "path": "/techniques/T1436/", "children": []}, {"name": "Domain Generation Algorithms", "id": "T1520", "path": "/techniques/T1520/", "children": []}, {"name": "Standard Application Layer Protocol", "id": "T1437", "path": "/techniques/T1437/", "children": []}, {"name": "Standard Cryptographic Protocol", "id": "T1521", "path": "/techniques/T1521/", "children": []}, {"name": "Uncommonly Used Port", "id": "T1509", "path": "/techniques/T1509/", "children": []}, {"name": "Web Service", "id": "T1481", "path": "/techniques/T1481/", "children": []}]}, {"name": "Network Effects", "id": "TA0038", "path": "/tactics/TA0038", "children": [{"name": "Downgrade to Insecure Protocols", "id": "T1466", "path": "/techniques/T1466/", "children": []}, {"name": "Eavesdrop on Insecure Network Communication", "id": "T1439", "path": "/techniques/T1439/", "children": []}, {"name": "Exploit SS7 to Redirect Phone Calls/SMS", "id": "T1449", "path": "/techniques/T1449/", "children": []}, {"name": "Exploit SS7 to Track Device Location", "id": "T1450", "path": "/techniques/T1450/", "children": []}, {"name": "Jamming or Denial of Service", "id": "T1464", "path": "/techniques/T1464/", "children": []}, {"name": "Manipulate Device Communication", "id": "T1463", "path": "/techniques/T1463/", "children": []}, {"name": "Rogue Cellular Base Station", "id": "T1467", "path": "/techniques/T1467/", "children": []}, {"name": "Rogue Wi-Fi Access Points", "id": "T1465", "path": "/techniques/T1465/", "children": []}, {"name": "SIM Card Swap", "id": "T1451", "path": "/techniques/T1451/", "children": []}]}, {"name": "Remote Service Effects", "id": "TA0039", "path": "/tactics/TA0039", "children": [{"name": "Obtain Device Cloud Backups", "id": "T1470", "path": "/techniques/T1470/", "children": []}, {"name": "Remotely Track Device Without Authorization", "id": "T1468", "path": "/techniques/T1468/", "children": []}, {"name": "Remotely Wipe Data Without Authorization", "id": "T1469", "path": "/techniques/T1469/", "children": []}]}]}, "name": "URL Scheme Hijacking", "mtcs": [{"id": "AUT-10", "url": "https://pages.nist.gov/mobile-threat-catalogue/authentication-threats/AUT-10.html"}], "descr": "<p>An iOS application may be able to maliciously claim a URL scheme, allowing it to intercept calls that are meant for a different application<span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"FireEye-Masque2\"><sup><a href=\"https://www.fireeye.com/blog/threat-research/2015/02/ios_masque_attackre.html\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span><span onclick=scrollToRef('scite-2') id=\"scite-ref-2-a\" class=\"scite-citeref-number\" data-reference=\"Dhanjani-URLScheme\"><sup><a href=\"http://www.dhanjani.com/blog/2010/11/insecure-handling-of-url-schemes-in-apples-ios.html\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span>. This technique, for example, could be used to capture OAuth authorization codes<span onclick=scrollToRef('scite-3') id=\"scite-ref-3-a\" class=\"scite-citeref-number\" data-reference=\"IETF-PKCE\"><sup><a href=\"https://tools.ietf.org/html/rfc7636\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span> or to phish user credentials<span onclick=scrollToRef('scite-4') id=\"scite-ref-4-a\" class=\"scite-citeref-number\" data-reference=\"MobileIron-XARA\"><sup><a href=\"https://www.mobileiron.com/en/smartwork-blog/ios-url-scheme-hijacking-xara-attack-analysis-and-countermeasures\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span>.</p>", "mitigation_table": [{"mid": "M1005", "name": "Application Vetting", "descr": "<p>Check for potential malicious definitions of URL schemes when vetting applications. Also, when examining apps for potential vulnerabilities, encourage use of universal links as an alternative to URL schemes. When examining apps that use OAuth, encourage use of best practices.<span onclick=scrollToRef('scite-5') id=\"scite-ref-5-a\" class=\"scite-citeref-number\" data-reference=\"Apple-UniversalLinks\"><sup><a href=\"https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span><span onclick=scrollToRef('scite-6') id=\"scite-ref-6-a\" class=\"scite-citeref-number\" data-reference=\"IETF-OAuthNativeApps\"><sup><a href=\"https://tools.ietf.org/html/rfc8252\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p>"}], "rel_techniques_table": [], "examples_table": [], "version": "1.1", "tactics": ["Credential Access"], "platforms": "iOS", "tactic_type": "Post-Adversary Device Access", "bottom_ref": [{"description": "Hui Xue, Tao Wei, Yulong Zhang, Song Jin, Zhaofeng Chen. (2015, February 19). IOS MASQUE ATTACK REVIVED: BYPASSING PROMPT FOR TRUST AND APP URL SCHEME HIJACKING. Retrieved December 21, 2016.", "url": "https://www.fireeye.com/blog/threat-research/2015/02/ios_masque_attackre.html", "sname": "FireEye-Masque2", "number": 1}, {"description": "Nitesh Dhanjani. (2010, November 8). Insecure Handling of URL Schemes in Apple\u2019s iOS. Retrieved December 21, 2016.", "url": "http://www.dhanjani.com/blog/2010/11/insecure-handling-of-url-schemes-in-apples-ios.html", "sname": "Dhanjani-URLScheme", "number": 2}, {"description": "N. Sakimura, J. Bradley, and N. Agarwal. (2015, September). IETF RFC 7636: Proof Key for Code Exchange by OAuth Public Clients. Retrieved December 21, 2016.", "url": "https://tools.ietf.org/html/rfc7636", "sname": "IETF-PKCE", "number": 3}, {"description": "Michael T. Raggo. (2015, October 1). iOS URL Scheme Hijacking (XARA) Attack Analysis and Countermeasures. Retrieved December 21, 2016.", "url": "https://www.mobileiron.com/en/smartwork-blog/ios-url-scheme-hijacking-xara-attack-analysis-and-countermeasures", "sname": "MobileIron-XARA", "number": 4}, {"description": "Apple. (n.d.). Support Universal Links. Retrieved December 21, 2016.", "url": "https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html", "sname": "Apple-UniversalLinks", "number": 5}, {"description": "W. Denniss and J. Bradley. (2017, October). IETF RFC 8252: OAuth 2.0 for Native Apps. Retrieved November 30, 2018.", "url": "https://tools.ietf.org/html/rfc8252", "sname": "IETF-OAuthNativeApps", "number": 6}]}