Title: Office Application Startup-['Persistence']-enterprise
Template: techniques/technique
save_as: techniques/T1137/index.html
data: {"attack_id": "T1137", "domain": "enterprise", "menu": {"name": "techniques", "id": "techniques", "path": "/techniques/enterprise/", "children": [{"name": "Initial Access", "id": "TA0001", "path": "/tactics/TA0001", "children": [{"name": "Drive-by Compromise", "id": "T1189", "path": "/techniques/T1189/", "children": []}, {"name": "Exploit Public-Facing Application", "id": "T1190", "path": "/techniques/T1190/", "children": []}, {"name": "External Remote Services", "id": "T1133", "path": "/techniques/T1133/", "children": []}, {"name": "Hardware Additions", "id": "T1200", "path": "/techniques/T1200/", "children": []}, {"name": "Replication Through Removable Media", "id": "T1091", "path": "/techniques/T1091/", "children": []}, {"name": "Spearphishing Attachment", "id": "T1193", "path": "/techniques/T1193/", "children": []}, {"name": "Spearphishing Link", "id": "T1192", "path": "/techniques/T1192/", "children": []}, {"name": "Spearphishing via Service", "id": "T1194", "path": "/techniques/T1194/", "children": []}, {"name": "Supply Chain Compromise", "id": "T1195", "path": "/techniques/T1195/", "children": []}, {"name": "Trusted Relationship", "id": "T1199", "path": "/techniques/T1199/", "children": []}, {"name": "Valid Accounts", "id": "T1078", "path": "/techniques/T1078/", "children": []}]}, {"name": "Execution", "id": "TA0002", "path": "/tactics/TA0002", "children": [{"name": "AppleScript", "id": "T1155", "path": "/techniques/T1155/", "children": []}, {"name": "CMSTP", "id": "T1191", "path": "/techniques/T1191/", "children": []}, {"name": "Command-Line Interface", "id": "T1059", "path": "/techniques/T1059/", "children": []}, {"name": "Compiled HTML File", "id": "T1223", "path": "/techniques/T1223/", "children": []}, {"name": "Component Object Model and Distributed COM", "id": "T1175", "path": "/techniques/T1175/", "children": []}, {"name": "Control Panel Items", "id": "T1196", "path": "/techniques/T1196/", "children": []}, {"name": "Dynamic Data Exchange", "id": "T1173", "path": "/techniques/T1173/", "children": []}, {"name": "Execution through API", "id": "T1106", "path": "/techniques/T1106/", "children": []}, {"name": "Execution through Module Load", "id": "T1129", "path": "/techniques/T1129/", "children": []}, {"name": "Exploitation for Client Execution", "id": "T1203", "path": "/techniques/T1203/", "children": []}, {"name": "Graphical User Interface", "id": "T1061", "path": "/techniques/T1061/", "children": []}, {"name": "InstallUtil", "id": "T1118", "path": "/techniques/T1118/", "children": []}, {"name": "Launchctl", "id": "T1152", "path": "/techniques/T1152/", "children": []}, {"name": "Local Job Scheduling", "id": "T1168", "path": "/techniques/T1168/", "children": []}, {"name": "LSASS Driver", "id": "T1177", "path": "/techniques/T1177/", "children": []}, {"name": "Mshta", "id": "T1170", "path": "/techniques/T1170/", "children": []}, {"name": "PowerShell", "id": "T1086", "path": "/techniques/T1086/", "children": []}, {"name": "Regsvcs/Regasm", "id": "T1121", "path": "/techniques/T1121/", "children": []}, {"name": "Regsvr32", "id": "T1117", "path": "/techniques/T1117/", "children": []}, {"name": "Rundll32", "id": "T1085", "path": "/techniques/T1085/", "children": []}, {"name": "Scheduled Task", "id": "T1053", "path": "/techniques/T1053/", "children": []}, {"name": "Scripting", "id": "T1064", "path": "/techniques/T1064/", "children": []}, {"name": "Service Execution", "id": "T1035", "path": "/techniques/T1035/", "children": []}, {"name": "Signed Binary Proxy Execution", "id": "T1218", "path": "/techniques/T1218/", "children": []}, {"name": "Signed Script Proxy Execution", "id": "T1216", "path": "/techniques/T1216/", "children": []}, {"name": "Source", "id": "T1153", "path": "/techniques/T1153/", "children": []}, {"name": "Space after Filename", "id": "T1151", "path": "/techniques/T1151/", "children": []}, {"name": "Third-party Software", "id": "T1072", "path": "/techniques/T1072/", "children": []}, {"name": "Trap", "id": "T1154", "path": "/techniques/T1154/", "children": []}, {"name": "Trusted Developer Utilities", "id": "T1127", "path": "/techniques/T1127/", "children": []}, {"name": "User Execution", "id": "T1204", "path": "/techniques/T1204/", "children": []}, {"name": "Windows Management Instrumentation", "id": "T1047", "path": "/techniques/T1047/", "children": []}, {"name": "Windows Remote Management", "id": "T1028", "path": "/techniques/T1028/", "children": []}, {"name": "XSL Script Processing", "id": "T1220", "path": "/techniques/T1220/", "children": []}]}, {"name": "Persistence", "id": "TA0003", "path": "/tactics/TA0003", "children": [{"name": ".bash_profile and .bashrc", "id": "T1156", "path": "/techniques/T1156/", "children": []}, {"name": "Accessibility Features", "id": "T1015", "path": "/techniques/T1015/", "children": []}, {"name": "Account Manipulation", "id": "T1098", "path": "/techniques/T1098/", "children": []}, {"name": "AppCert DLLs", "id": "T1182", "path": "/techniques/T1182/", "children": []}, {"name": "AppInit DLLs", "id": "T1103", "path": "/techniques/T1103/", "children": []}, {"name": "Application Shimming", "id": "T1138", "path": "/techniques/T1138/", "children": []}, {"name": "Authentication Package", "id": "T1131", "path": "/techniques/T1131/", "children": []}, {"name": "BITS Jobs", "id": "T1197", "path": "/techniques/T1197/", "children": []}, {"name": "Bootkit", "id": "T1067", "path": "/techniques/T1067/", "children": []}, {"name": "Browser Extensions", "id": "T1176", "path": "/techniques/T1176/", "children": []}, {"name": "Change Default File Association", "id": "T1042", "path": "/techniques/T1042/", "children": []}, {"name": "Component Firmware", "id": "T1109", "path": "/techniques/T1109/", "children": []}, {"name": "Component Object Model Hijacking", "id": "T1122", "path": "/techniques/T1122/", "children": []}, {"name": "Create Account", "id": "T1136", "path": "/techniques/T1136/", "children": []}, {"name": "DLL Search Order Hijacking", "id": "T1038", "path": "/techniques/T1038/", "children": []}, {"name": "Dylib Hijacking", "id": "T1157", "path": "/techniques/T1157/", "children": []}, {"name": "Emond", "id": "T1519", "path": "/techniques/T1519/", "children": []}, {"name": "External Remote Services", "id": "T1133", "path": "/techniques/T1133/", "children": []}, {"name": "File System Permissions Weakness", "id": "T1044", "path": "/techniques/T1044/", "children": []}, {"name": "Hidden Files and Directories", "id": "T1158", "path": "/techniques/T1158/", "children": []}, {"name": "Hooking", "id": "T1179", "path": "/techniques/T1179/", "children": []}, {"name": "Hypervisor", "id": "T1062", "path": "/techniques/T1062/", "children": []}, {"name": "Image File Execution Options Injection", "id": "T1183", "path": "/techniques/T1183/", "children": []}, {"name": "Implant Container Image", "id": "T1525", "path": "/techniques/T1525/", "children": []}, {"name": "Kernel Modules and Extensions", "id": "T1215", "path": "/techniques/T1215/", "children": []}, {"name": "Launch Agent", "id": "T1159", "path": "/techniques/T1159/", "children": []}, {"name": "Launch Daemon", "id": "T1160", "path": "/techniques/T1160/", "children": []}, {"name": "Launchctl", "id": "T1152", "path": "/techniques/T1152/", "children": []}, {"name": "LC_LOAD_DYLIB Addition", "id": "T1161", "path": "/techniques/T1161/", "children": []}, {"name": "Local Job Scheduling", "id": "T1168", "path": "/techniques/T1168/", "children": []}, {"name": "Login Item", "id": "T1162", "path": "/techniques/T1162/", "children": []}, {"name": "Logon Scripts", "id": "T1037", "path": "/techniques/T1037/", "children": []}, {"name": "LSASS Driver", "id": "T1177", "path": "/techniques/T1177/", "children": []}, {"name": "Modify Existing Service", "id": "T1031", "path": "/techniques/T1031/", "children": []}, {"name": "Netsh Helper DLL", "id": "T1128", "path": "/techniques/T1128/", "children": []}, {"name": "New Service", "id": "T1050", "path": "/techniques/T1050/", "children": []}, {"name": "Office Application Startup", "id": "T1137", "path": "/techniques/T1137/", "children": []}, {"name": "Path Interception", "id": "T1034", "path": "/techniques/T1034/", "children": []}, {"name": "Plist Modification", "id": "T1150", "path": "/techniques/T1150/", "children": []}, {"name": "Port Knocking", "id": "T1205", "path": "/techniques/T1205/", "children": []}, {"name": "Port Monitors", "id": "T1013", "path": "/techniques/T1013/", "children": []}, {"name": "PowerShell Profile", "id": "T1504", "path": "/techniques/T1504/", "children": []}, {"name": "Rc.common", "id": "T1163", "path": "/techniques/T1163/", "children": []}, {"name": "Re-opened Applications", "id": "T1164", "path": "/techniques/T1164/", "children": []}, {"name": "Redundant Access", "id": "T1108", "path": "/techniques/T1108/", "children": []}, {"name": "Registry Run Keys / Startup Folder", "id": "T1060", "path": "/techniques/T1060/", "children": []}, {"name": "Scheduled Task", "id": "T1053", "path": "/techniques/T1053/", "children": []}, {"name": "Screensaver", "id": "T1180", "path": "/techniques/T1180/", "children": []}, {"name": "Security Support Provider", "id": "T1101", "path": "/techniques/T1101/", "children": []}, {"name": "Server Software Component", "id": "T1505", "path": "/techniques/T1505/", "children": []}, {"name": "Service Registry Permissions Weakness", "id": "T1058", "path": "/techniques/T1058/", "children": []}, {"name": "Setuid and Setgid", "id": "T1166", "path": "/techniques/T1166/", "children": []}, {"name": "Shortcut Modification", "id": "T1023", "path": "/techniques/T1023/", "children": []}, {"name": "SIP and Trust Provider Hijacking", "id": "T1198", "path": "/techniques/T1198/", "children": []}, {"name": "Startup Items", "id": "T1165", "path": "/techniques/T1165/", "children": []}, {"name": "System Firmware", "id": "T1019", "path": "/techniques/T1019/", "children": []}, {"name": "Systemd Service", "id": "T1501", "path": "/techniques/T1501/", "children": []}, {"name": "Time Providers", "id": "T1209", "path": "/techniques/T1209/", "children": []}, {"name": "Trap", "id": "T1154", "path": "/techniques/T1154/", "children": []}, {"name": "Valid Accounts", "id": "T1078", "path": "/techniques/T1078/", "children": []}, {"name": "Web Shell", "id": "T1100", "path": "/techniques/T1100/", "children": []}, {"name": "Windows Management Instrumentation Event Subscription", "id": "T1084", "path": "/techniques/T1084/", "children": []}, {"name": "Winlogon Helper DLL", "id": "T1004", "path": "/techniques/T1004/", "children": []}]}, {"name": "Privilege Escalation", "id": "TA0004", "path": "/tactics/TA0004", "children": [{"name": "Access Token Manipulation", "id": "T1134", "path": "/techniques/T1134/", "children": []}, {"name": "Accessibility Features", "id": "T1015", "path": "/techniques/T1015/", "children": []}, {"name": "AppCert DLLs", "id": "T1182", "path": "/techniques/T1182/", "children": []}, {"name": "AppInit DLLs", "id": "T1103", "path": "/techniques/T1103/", "children": []}, {"name": "Application Shimming", "id": "T1138", "path": "/techniques/T1138/", "children": []}, {"name": "Bypass User Account Control", "id": "T1088", "path": "/techniques/T1088/", "children": []}, {"name": "DLL Search Order Hijacking", "id": "T1038", "path": "/techniques/T1038/", "children": []}, {"name": "Dylib Hijacking", "id": "T1157", "path": "/techniques/T1157/", "children": []}, {"name": "Elevated Execution with Prompt", "id": "T1514", "path": "/techniques/T1514/", "children": []}, {"name": "Emond", "id": "T1519", "path": "/techniques/T1519/", "children": []}, {"name": "Exploitation for Privilege Escalation", "id": "T1068", "path": "/techniques/T1068/", "children": []}, {"name": "Extra Window Memory Injection", "id": "T1181", "path": "/techniques/T1181/", "children": []}, {"name": "File System Permissions Weakness", "id": "T1044", "path": "/techniques/T1044/", "children": []}, {"name": "Hooking", "id": "T1179", "path": "/techniques/T1179/", "children": []}, {"name": "Image File Execution Options Injection", "id": "T1183", "path": "/techniques/T1183/", "children": []}, {"name": "Launch Daemon", "id": "T1160", "path": "/techniques/T1160/", "children": []}, {"name": "New Service", "id": "T1050", "path": "/techniques/T1050/", "children": []}, {"name": "Parent PID Spoofing", "id": "T1502", "path": "/techniques/T1502/", "children": []}, {"name": "Path Interception", "id": "T1034", "path": "/techniques/T1034/", "children": []}, {"name": "Plist Modification", "id": "T1150", "path": "/techniques/T1150/", "children": []}, {"name": "Port Monitors", "id": "T1013", "path": "/techniques/T1013/", "children": []}, {"name": "PowerShell Profile", "id": "T1504", "path": "/techniques/T1504/", "children": []}, {"name": "Process Injection", "id": "T1055", "path": "/techniques/T1055/", "children": []}, {"name": "Scheduled Task", "id": "T1053", "path": "/techniques/T1053/", "children": []}, {"name": "Service Registry Permissions Weakness", "id": "T1058", "path": "/techniques/T1058/", "children": []}, {"name": "Setuid and Setgid", "id": "T1166", "path": "/techniques/T1166/", "children": []}, {"name": "SID-History Injection", "id": "T1178", "path": "/techniques/T1178/", "children": []}, {"name": "Startup Items", "id": "T1165", "path": "/techniques/T1165/", "children": []}, {"name": "Sudo", "id": "T1169", "path": "/techniques/T1169/", "children": []}, {"name": "Sudo Caching", "id": "T1206", "path": "/techniques/T1206/", "children": []}, {"name": "Valid Accounts", "id": "T1078", "path": "/techniques/T1078/", "children": []}, {"name": "Web Shell", "id": "T1100", "path": "/techniques/T1100/", "children": []}]}, {"name": "Defense Evasion", "id": "TA0005", "path": "/tactics/TA0005", "children": [{"name": "Access Token Manipulation", "id": "T1134", "path": "/techniques/T1134/", "children": []}, {"name": "Application Access Token", "id": "T1527", "path": "/techniques/T1527/", "children": []}, {"name": "Binary Padding", "id": "T1009", "path": "/techniques/T1009/", "children": []}, {"name": "BITS Jobs", "id": "T1197", "path": "/techniques/T1197/", "children": []}, {"name": "Bypass User Account Control", "id": "T1088", "path": "/techniques/T1088/", "children": []}, {"name": "Clear Command History", "id": "T1146", "path": "/techniques/T1146/", "children": []}, {"name": "CMSTP", "id": "T1191", "path": "/techniques/T1191/", "children": []}, {"name": "Code Signing", "id": "T1116", "path": "/techniques/T1116/", "children": []}, {"name": "Compile After Delivery", "id": "T1500", "path": "/techniques/T1500/", "children": []}, {"name": "Compiled HTML File", "id": "T1223", "path": "/techniques/T1223/", "children": []}, {"name": "Component Firmware", "id": "T1109", "path": "/techniques/T1109/", "children": []}, {"name": "Component Object Model Hijacking", "id": "T1122", "path": "/techniques/T1122/", "children": []}, {"name": "Connection Proxy", "id": "T1090", "path": "/techniques/T1090/", "children": []}, {"name": "Control Panel Items", "id": "T1196", "path": "/techniques/T1196/", "children": []}, {"name": "DCShadow", "id": "T1207", "path": "/techniques/T1207/", "children": []}, {"name": "Deobfuscate/Decode Files or Information", "id": "T1140", "path": "/techniques/T1140/", "children": []}, {"name": "Disabling Security Tools", "id": "T1089", "path": "/techniques/T1089/", "children": []}, {"name": "DLL Search Order Hijacking", "id": "T1038", "path": "/techniques/T1038/", "children": []}, {"name": "DLL Side-Loading", "id": "T1073", "path": "/techniques/T1073/", "children": []}, {"name": "Execution Guardrails", "id": "T1480", "path": "/techniques/T1480/", "children": []}, {"name": "Exploitation for Defense Evasion", "id": "T1211", "path": "/techniques/T1211/", "children": []}, {"name": "Extra Window Memory Injection", "id": "T1181", "path": "/techniques/T1181/", "children": []}, {"name": "File and Directory Permissions Modification", "id": "T1222", "path": "/techniques/T1222/", "children": []}, {"name": "File Deletion", "id": "T1107", "path": "/techniques/T1107/", "children": []}, {"name": "File System Logical Offsets", "id": "T1006", "path": "/techniques/T1006/", "children": []}, {"name": "Gatekeeper Bypass", "id": "T1144", "path": "/techniques/T1144/", "children": []}, {"name": "Group Policy Modification", "id": "T1484", "path": "/techniques/T1484/", "children": []}, {"name": "Hidden Files and Directories", "id": "T1158", "path": "/techniques/T1158/", "children": []}, {"name": "Hidden Users", "id": "T1147", "path": "/techniques/T1147/", "children": []}, {"name": "Hidden Window", "id": "T1143", "path": "/techniques/T1143/", "children": []}, {"name": "HISTCONTROL", "id": "T1148", "path": "/techniques/T1148/", "children": []}, {"name": "Image File Execution Options Injection", "id": "T1183", "path": "/techniques/T1183/", "children": []}, {"name": "Indicator Blocking", "id": "T1054", "path": "/techniques/T1054/", "children": []}, {"name": "Indicator Removal from Tools", "id": "T1066", "path": "/techniques/T1066/", "children": []}, {"name": "Indicator Removal on Host", "id": "T1070", "path": "/techniques/T1070/", "children": []}, {"name": "Indirect Command Execution", "id": "T1202", "path": "/techniques/T1202/", "children": []}, {"name": "Install Root Certificate", "id": "T1130", "path": "/techniques/T1130/", "children": []}, {"name": "InstallUtil", "id": "T1118", "path": "/techniques/T1118/", "children": []}, {"name": "Launchctl", "id": "T1152", "path": "/techniques/T1152/", "children": []}, {"name": "LC_MAIN Hijacking", "id": "T1149", "path": "/techniques/T1149/", "children": []}, {"name": "Masquerading", "id": "T1036", "path": "/techniques/T1036/", "children": []}, {"name": "Modify Registry", "id": "T1112", "path": "/techniques/T1112/", "children": []}, {"name": "Mshta", "id": "T1170", "path": "/techniques/T1170/", "children": []}, {"name": "Network Share Connection Removal", "id": "T1126", "path": "/techniques/T1126/", "children": []}, {"name": "NTFS File Attributes", "id": "T1096", "path": "/techniques/T1096/", "children": []}, {"name": "Obfuscated Files or Information", "id": "T1027", "path": "/techniques/T1027/", "children": []}, {"name": "Parent PID Spoofing", "id": "T1502", "path": "/techniques/T1502/", "children": []}, {"name": "Plist Modification", "id": "T1150", "path": "/techniques/T1150/", "children": []}, {"name": "Port Knocking", "id": "T1205", "path": "/techniques/T1205/", "children": []}, {"name": "Process Doppelg\u00e4nging", "id": "T1186", "path": "/techniques/T1186/", "children": []}, {"name": "Process Hollowing", "id": "T1093", "path": "/techniques/T1093/", "children": []}, {"name": "Process Injection", "id": "T1055", "path": "/techniques/T1055/", "children": []}, {"name": "Redundant Access", "id": "T1108", "path": "/techniques/T1108/", "children": []}, {"name": "Regsvcs/Regasm", "id": "T1121", "path": "/techniques/T1121/", "children": []}, {"name": "Regsvr32", "id": "T1117", "path": "/techniques/T1117/", "children": []}, {"name": "Revert Cloud Instance", "id": "T1536", "path": "/techniques/T1536/", "children": []}, {"name": "Rootkit", "id": "T1014", "path": "/techniques/T1014/", "children": []}, {"name": "Rundll32", "id": "T1085", "path": "/techniques/T1085/", "children": []}, {"name": "Scripting", "id": "T1064", "path": "/techniques/T1064/", "children": []}, {"name": "Signed Binary Proxy Execution", "id": "T1218", "path": "/techniques/T1218/", "children": []}, {"name": "Signed Script Proxy Execution", "id": "T1216", "path": "/techniques/T1216/", "children": []}, {"name": "SIP and Trust Provider Hijacking", "id": "T1198", "path": "/techniques/T1198/", "children": []}, {"name": "Software Packing", "id": "T1045", "path": "/techniques/T1045/", "children": []}, {"name": "Space after Filename", "id": "T1151", "path": "/techniques/T1151/", "children": []}, {"name": "Template Injection", "id": "T1221", "path": "/techniques/T1221/", "children": []}, {"name": "Timestomp", "id": "T1099", "path": "/techniques/T1099/", "children": []}, {"name": "Trusted Developer Utilities", "id": "T1127", "path": "/techniques/T1127/", "children": []}, {"name": "Unused/Unsupported Cloud Regions", "id": "T1535", "path": "/techniques/T1535/", "children": []}, {"name": "Valid Accounts", "id": "T1078", "path": "/techniques/T1078/", "children": []}, {"name": "Virtualization/Sandbox Evasion", "id": "T1497", "path": "/techniques/T1497/", "children": []}, {"name": "Web Service", "id": "T1102", "path": "/techniques/T1102/", "children": []}, {"name": "Web Session Cookie", "id": "T1506", "path": "/techniques/T1506/", "children": []}, {"name": "XSL Script Processing", "id": "T1220", "path": "/techniques/T1220/", "children": []}]}, {"name": "Credential Access", "id": "TA0006", "path": "/tactics/TA0006", "children": [{"name": "Account Manipulation", "id": "T1098", "path": "/techniques/T1098/", "children": []}, {"name": "Bash History", "id": "T1139", "path": "/techniques/T1139/", "children": []}, {"name": "Brute Force", "id": "T1110", "path": "/techniques/T1110/", "children": []}, {"name": "Cloud Instance Metadata API", "id": "T1522", "path": "/techniques/T1522/", "children": []}, {"name": "Credential Dumping", "id": "T1003", "path": "/techniques/T1003/", "children": []}, {"name": "Credentials from Web Browsers", "id": "T1503", "path": "/techniques/T1503/", "children": []}, {"name": "Credentials in Files", "id": "T1081", "path": "/techniques/T1081/", "children": []}, {"name": "Credentials in Registry", "id": "T1214", "path": "/techniques/T1214/", "children": []}, {"name": "Exploitation for Credential Access", "id": "T1212", "path": "/techniques/T1212/", "children": []}, {"name": "Forced Authentication", "id": "T1187", "path": "/techniques/T1187/", "children": []}, {"name": "Hooking", "id": "T1179", "path": "/techniques/T1179/", "children": []}, {"name": "Input Capture", "id": "T1056", "path": "/techniques/T1056/", "children": []}, {"name": "Input Prompt", "id": "T1141", "path": "/techniques/T1141/", "children": []}, {"name": "Kerberoasting", "id": "T1208", "path": "/techniques/T1208/", "children": []}, {"name": "Keychain", "id": "T1142", "path": "/techniques/T1142/", "children": []}, {"name": "LLMNR/NBT-NS Poisoning and Relay", "id": "T1171", "path": "/techniques/T1171/", "children": []}, {"name": "Network Sniffing", "id": "T1040", "path": "/techniques/T1040/", "children": []}, {"name": "Password Filter DLL", "id": "T1174", "path": "/techniques/T1174/", "children": []}, {"name": "Private Keys", "id": "T1145", "path": "/techniques/T1145/", "children": []}, {"name": "Securityd Memory", "id": "T1167", "path": "/techniques/T1167/", "children": []}, {"name": "Steal Application Access Token", "id": "T1528", "path": "/techniques/T1528/", "children": []}, {"name": "Steal Web Session Cookie", "id": "T1539", "path": "/techniques/T1539/", "children": []}, {"name": "Two-Factor Authentication Interception", "id": "T1111", "path": "/techniques/T1111/", "children": []}]}, {"name": "Discovery", "id": "TA0007", "path": "/tactics/TA0007", "children": [{"name": "Account Discovery", "id": "T1087", "path": "/techniques/T1087/", "children": []}, {"name": "Application Window Discovery", "id": "T1010", "path": "/techniques/T1010/", "children": []}, {"name": "Browser Bookmark Discovery", "id": "T1217", "path": "/techniques/T1217/", "children": []}, {"name": "Cloud Service Dashboard", "id": "T1538", "path": "/techniques/T1538/", "children": []}, {"name": "Cloud Service Discovery", "id": "T1526", "path": "/techniques/T1526/", "children": []}, {"name": "Domain Trust Discovery", "id": "T1482", "path": "/techniques/T1482/", "children": []}, {"name": "File and Directory Discovery", "id": "T1083", "path": "/techniques/T1083/", "children": []}, {"name": "Network Service Scanning", "id": "T1046", "path": "/techniques/T1046/", "children": []}, {"name": "Network Share Discovery", "id": "T1135", "path": "/techniques/T1135/", "children": []}, {"name": "Network Sniffing", "id": "T1040", "path": "/techniques/T1040/", "children": []}, {"name": "Password Policy Discovery", "id": "T1201", "path": "/techniques/T1201/", "children": []}, {"name": "Peripheral Device Discovery", "id": "T1120", "path": "/techniques/T1120/", "children": []}, {"name": "Permission Groups Discovery", "id": "T1069", "path": "/techniques/T1069/", "children": []}, {"name": "Process Discovery", "id": "T1057", "path": "/techniques/T1057/", "children": []}, {"name": "Query Registry", "id": "T1012", "path": "/techniques/T1012/", "children": []}, {"name": "Remote System Discovery", "id": "T1018", "path": "/techniques/T1018/", "children": []}, {"name": "Security Software Discovery", "id": "T1063", "path": "/techniques/T1063/", "children": []}, {"name": "Software Discovery", "id": "T1518", "path": "/techniques/T1518/", "children": []}, {"name": "System Information Discovery", "id": "T1082", "path": "/techniques/T1082/", "children": []}, {"name": "System Network Configuration Discovery", "id": "T1016", "path": "/techniques/T1016/", "children": []}, {"name": "System Network Connections Discovery", "id": "T1049", "path": "/techniques/T1049/", "children": []}, {"name": "System Owner/User Discovery", "id": "T1033", "path": "/techniques/T1033/", "children": []}, {"name": "System Service Discovery", "id": "T1007", "path": "/techniques/T1007/", "children": []}, {"name": "System Time Discovery", "id": "T1124", "path": "/techniques/T1124/", "children": []}, {"name": "Virtualization/Sandbox Evasion", "id": "T1497", "path": "/techniques/T1497/", "children": []}]}, {"name": "Lateral Movement", "id": "TA0008", "path": "/tactics/TA0008", "children": [{"name": "AppleScript", "id": "T1155", "path": "/techniques/T1155/", "children": []}, {"name": "Application Access Token", "id": "T1527", "path": "/techniques/T1527/", "children": []}, {"name": "Application Deployment Software", "id": "T1017", "path": "/techniques/T1017/", "children": []}, {"name": "Component Object Model and Distributed COM", "id": "T1175", "path": "/techniques/T1175/", "children": []}, {"name": "Exploitation of Remote Services", "id": "T1210", "path": "/techniques/T1210/", "children": []}, {"name": "Internal Spearphishing", "id": "T1534", "path": "/techniques/T1534/", "children": []}, {"name": "Logon Scripts", "id": "T1037", "path": "/techniques/T1037/", "children": []}, {"name": "Pass the Hash", "id": "T1075", "path": "/techniques/T1075/", "children": []}, {"name": "Pass the Ticket", "id": "T1097", "path": "/techniques/T1097/", "children": []}, {"name": "Remote Desktop Protocol", "id": "T1076", "path": "/techniques/T1076/", "children": []}, {"name": "Remote File Copy", "id": "T1105", "path": "/techniques/T1105/", "children": []}, {"name": "Remote Services", "id": "T1021", "path": "/techniques/T1021/", "children": []}, {"name": "Replication Through Removable Media", "id": "T1091", "path": "/techniques/T1091/", "children": []}, {"name": "Shared Webroot", "id": "T1051", "path": "/techniques/T1051/", "children": []}, {"name": "SSH Hijacking", "id": "T1184", "path": "/techniques/T1184/", "children": []}, {"name": "Taint Shared Content", "id": "T1080", "path": "/techniques/T1080/", "children": []}, {"name": "Third-party Software", "id": "T1072", "path": "/techniques/T1072/", "children": []}, {"name": "Web Session Cookie", "id": "T1506", "path": "/techniques/T1506/", "children": []}, {"name": "Windows Admin Shares", "id": "T1077", "path": "/techniques/T1077/", "children": []}, {"name": "Windows Remote Management", "id": "T1028", "path": "/techniques/T1028/", "children": []}]}, {"name": "Collection", "id": "TA0009", "path": "/tactics/TA0009", "children": [{"name": "Audio Capture", "id": "T1123", "path": "/techniques/T1123/", "children": []}, {"name": "Automated Collection", "id": "T1119", "path": "/techniques/T1119/", "children": []}, {"name": "Clipboard Data", "id": "T1115", "path": "/techniques/T1115/", "children": []}, {"name": "Data from Cloud Storage Object", "id": "T1530", "path": "/techniques/T1530/", "children": []}, {"name": "Data from Information Repositories", "id": "T1213", "path": "/techniques/T1213/", "children": []}, {"name": "Data from Local System", "id": "T1005", "path": "/techniques/T1005/", "children": []}, {"name": "Data from Network Shared Drive", "id": "T1039", "path": "/techniques/T1039/", "children": []}, {"name": "Data from Removable Media", "id": "T1025", "path": "/techniques/T1025/", "children": []}, {"name": "Data Staged", "id": "T1074", "path": "/techniques/T1074/", "children": []}, {"name": "Email Collection", "id": "T1114", "path": "/techniques/T1114/", "children": []}, {"name": "Input Capture", "id": "T1056", "path": "/techniques/T1056/", "children": []}, {"name": "Man in the Browser", "id": "T1185", "path": "/techniques/T1185/", "children": []}, {"name": "Screen Capture", "id": "T1113", "path": "/techniques/T1113/", "children": []}, {"name": "Video Capture", "id": "T1125", "path": "/techniques/T1125/", "children": []}]}, {"name": "Command and Control", "id": "TA0011", "path": "/tactics/TA0011", "children": [{"name": "Commonly Used Port", "id": "T1043", "path": "/techniques/T1043/", "children": []}, {"name": "Communication Through Removable Media", "id": "T1092", "path": "/techniques/T1092/", "children": []}, {"name": "Connection Proxy", "id": "T1090", "path": "/techniques/T1090/", "children": []}, {"name": "Custom Command and Control Protocol", "id": "T1094", "path": "/techniques/T1094/", "children": []}, {"name": "Custom Cryptographic Protocol", "id": "T1024", "path": "/techniques/T1024/", "children": []}, {"name": "Data Encoding", "id": "T1132", "path": "/techniques/T1132/", "children": []}, {"name": "Data Obfuscation", "id": "T1001", "path": "/techniques/T1001/", "children": []}, {"name": "Domain Fronting", "id": "T1172", "path": "/techniques/T1172/", "children": []}, {"name": "Domain Generation Algorithms", "id": "T1483", "path": "/techniques/T1483/", "children": []}, {"name": "Fallback Channels", "id": "T1008", "path": "/techniques/T1008/", "children": []}, {"name": "Multi-hop Proxy", "id": "T1188", "path": "/techniques/T1188/", "children": []}, {"name": "Multi-Stage Channels", "id": "T1104", "path": "/techniques/T1104/", "children": []}, {"name": "Multiband Communication", "id": "T1026", "path": "/techniques/T1026/", "children": []}, {"name": "Multilayer Encryption", "id": "T1079", "path": "/techniques/T1079/", "children": []}, {"name": "Port Knocking", "id": "T1205", "path": "/techniques/T1205/", "children": []}, {"name": "Remote Access Tools", "id": "T1219", "path": "/techniques/T1219/", "children": []}, {"name": "Remote File Copy", "id": "T1105", "path": "/techniques/T1105/", "children": []}, {"name": "Standard Application Layer Protocol", "id": "T1071", "path": "/techniques/T1071/", "children": []}, {"name": "Standard Cryptographic Protocol", "id": "T1032", "path": "/techniques/T1032/", "children": []}, {"name": "Standard Non-Application Layer Protocol", "id": "T1095", "path": "/techniques/T1095/", "children": []}, {"name": "Uncommonly Used Port", "id": "T1065", "path": "/techniques/T1065/", "children": []}, {"name": "Web Service", "id": "T1102", "path": "/techniques/T1102/", "children": []}]}, {"name": "Exfiltration", "id": "TA0010", "path": "/tactics/TA0010", "children": [{"name": "Automated Exfiltration", "id": "T1020", "path": "/techniques/T1020/", "children": []}, {"name": "Data Compressed", "id": "T1002", "path": "/techniques/T1002/", "children": []}, {"name": "Data Encrypted", "id": "T1022", "path": "/techniques/T1022/", "children": []}, {"name": "Data Transfer Size Limits", "id": "T1030", "path": "/techniques/T1030/", "children": []}, {"name": "Exfiltration Over Alternative Protocol", "id": "T1048", "path": "/techniques/T1048/", "children": []}, {"name": "Exfiltration Over Command and Control Channel", "id": "T1041", "path": "/techniques/T1041/", "children": []}, {"name": "Exfiltration Over Other Network Medium", "id": "T1011", "path": "/techniques/T1011/", "children": []}, {"name": "Exfiltration Over Physical Medium", "id": "T1052", "path": "/techniques/T1052/", "children": []}, {"name": "Scheduled Transfer", "id": "T1029", "path": "/techniques/T1029/", "children": []}, {"name": "Transfer Data to Cloud Account", "id": "T1537", "path": "/techniques/T1537/", "children": []}]}, {"name": "Impact", "id": "TA0040", "path": "/tactics/TA0040", "children": [{"name": "Account Access Removal", "id": "T1531", "path": "/techniques/T1531/", "children": []}, {"name": "Data Destruction", "id": "T1485", "path": "/techniques/T1485/", "children": []}, {"name": "Data Encrypted for Impact", "id": "T1486", "path": "/techniques/T1486/", "children": []}, {"name": "Defacement", "id": "T1491", "path": "/techniques/T1491/", "children": []}, {"name": "Disk Content Wipe", "id": "T1488", "path": "/techniques/T1488/", "children": []}, {"name": "Disk Structure Wipe", "id": "T1487", "path": "/techniques/T1487/", "children": []}, {"name": "Endpoint Denial of Service", "id": "T1499", "path": "/techniques/T1499/", "children": []}, {"name": "Firmware Corruption", "id": "T1495", "path": "/techniques/T1495/", "children": []}, {"name": "Inhibit System Recovery", "id": "T1490", "path": "/techniques/T1490/", "children": []}, {"name": "Network Denial of Service", "id": "T1498", "path": "/techniques/T1498/", "children": []}, {"name": "Resource Hijacking", "id": "T1496", "path": "/techniques/T1496/", "children": []}, {"name": "Runtime Data Manipulation", "id": "T1494", "path": "/techniques/T1494/", "children": []}, {"name": "Service Stop", "id": "T1489", "path": "/techniques/T1489/", "children": []}, {"name": "Stored Data Manipulation", "id": "T1492", "path": "/techniques/T1492/", "children": []}, {"name": "System Shutdown/Reboot", "id": "T1529", "path": "/techniques/T1529/", "children": []}, {"name": "Transmitted Data Manipulation", "id": "T1493", "path": "/techniques/T1493/", "children": []}]}]}, "name": "Office Application Startup", "descr": "<p>Microsoft Office is a fairly common application suite on Windows-based operating systems within an enterprise network. There are multiple mechanisms that can be used with Office for persistence when an Office-based application is started.</p><h3>Office Template Macros</h3><p>Microsoft Office contains templates that are part of common Office applications and are used to customize styles. The base templates within the application are used each time an application starts. <span onclick=scrollToRef('scite-1') id=\"scite-ref-1-a\" class=\"scite-citeref-number\" data-reference=\"Microsoft Change Normal Template\"><sup><a href=\"https://support.office.com/article/Change-the-Normal-template-Normal-dotm-06de294b-d216-47f6-ab77-ccb5166f98ea\" target=\"_blank\" data-hasqtip=\"0\" aria-describedby=\"qtip-0\">[1]</a></sup></span></p><p>Office Visual Basic for Applications (VBA) macros <span onclick=scrollToRef('scite-2') id=\"scite-ref-2-a\" class=\"scite-citeref-number\" data-reference=\"MSDN VBA in Office\"><sup><a href=\"https://msdn.microsoft.com/en-us/vba/office-shared-vba/articles/getting-started-with-vba-in-office\" target=\"_blank\" data-hasqtip=\"1\" aria-describedby=\"qtip-1\">[2]</a></sup></span> can be inserted into the base template and used to execute code when the respective Office application starts in order to obtain persistence. Examples for both Word and Excel have been discovered and published. By default, Word has a Normal.dotm template created that can be modified to include a malicious macro. Excel does not have a template file created by default, but one can be added that will automatically be loaded.<span onclick=scrollToRef('scite-3') id=\"scite-ref-3-a\" class=\"scite-citeref-number\" data-reference=\"enigma0x3 normal.dotm\"><sup><a href=\"https://enigma0x3.net/2014/01/23/maintaining-access-with-normal-dotm/comment-page-1/\" target=\"_blank\" data-hasqtip=\"2\" aria-describedby=\"qtip-2\">[3]</a></sup></span><span onclick=scrollToRef('scite-4') id=\"scite-ref-4-a\" class=\"scite-citeref-number\" data-reference=\"Hexacorn Office Template Macros\"><sup><a href=\"http://www.hexacorn.com/blog/2017/04/19/beyond-good-ol-run-key-part-62/\" target=\"_blank\" data-hasqtip=\"3\" aria-describedby=\"qtip-3\">[4]</a></sup></span> Shared templates may also be stored and pulled from remote locations.<span onclick=scrollToRef('scite-5') id=\"scite-ref-5-a\" class=\"scite-citeref-number\" data-reference=\"GlobalDotName Jun 2019\"><sup><a href=\"https://www.221bluestreet.com/post/office-templates-and-globaldotname-a-stealthy-office-persistence-technique\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span> </p><p>Word Normal.dotm location:<code>C:\\Users\\(username)\\AppData\\Roaming\\Microsoft\\Templates\\Normal.dotm</code></p><p>Excel Personal.xlsb location:<code>C:\\Users\\(username)\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART\\PERSONAL.XLSB</code></p><p>Adversaries may also change the location of the base template to point to their own by hijacking the application's search order, e.g. Word 2016 will first look for Normal.dotm under <code>C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\</code>, or by modifying the GlobalDotName registry key. By modifying the GlobalDotName registry key an adversary can specify an arbitrary location, file name, and file extension to use for the template that will be loaded on application startup. To abuse GlobalDotName, adversaries may first need to register the template as a trusted document or place it in a trusted location.<span onclick=scrollToRef('scite-5') id=\"scite-ref-5-a\" class=\"scite-citeref-number\" data-reference=\"GlobalDotName Jun 2019\"><sup><a href=\"https://www.221bluestreet.com/post/office-templates-and-globaldotname-a-stealthy-office-persistence-technique\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span> </p><p>An adversary may need to enable macros to execute unrestricted depending on the system or enterprise security policy on use of macros.</p><h3>Office Test</h3><p>A Registry location was found that when a DLL reference was placed within it the corresponding DLL pointed to by the binary path would be executed every time an Office application is started <span onclick=scrollToRef('scite-6') id=\"scite-ref-6-a\" class=\"scite-citeref-number\" data-reference=\"Hexacorn Office Test\"><sup><a href=\"http://www.hexacorn.com/blog/2014/04/16/beyond-good-ol-run-key-part-10/\" target=\"_blank\" data-hasqtip=\"5\" aria-describedby=\"qtip-5\">[6]</a></sup></span></p><p><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office test\\Special\\Perf</code></p><h3>Add-ins</h3><p>Office add-ins can be used to add functionality to Office programs. <span onclick=scrollToRef('scite-7') id=\"scite-ref-7-a\" class=\"scite-citeref-number\" data-reference=\"Microsoft Office Add-ins\"><sup><a href=\"https://support.office.com/article/Add-or-remove-add-ins-0af570c4-5cf3-4fa9-9b88-403625a0b460\" target=\"_blank\" data-hasqtip=\"6\" aria-describedby=\"qtip-6\">[7]</a></sup></span></p><p>Add-ins can also be used to obtain persistence because they can be set to execute code when an Office application starts. There are different types of add-ins that can be used by the various Office products; including Word/Excel add-in Libraries (WLL/XLL), VBA add-ins, Office Component Object Model (COM) add-ins, automation add-ins, VBA Editor (VBE), Visual Studio Tools for Office (VSTO) add-ins, and Outlook add-ins. <span onclick=scrollToRef('scite-8') id=\"scite-ref-8-a\" class=\"scite-citeref-number\" data-reference=\"MRWLabs Office Persistence Add-ins\"><sup><a href=\"https://labs.mwrinfosecurity.com/blog/add-in-opportunities-for-office-persistence/\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span><span onclick=scrollToRef('scite-9') id=\"scite-ref-9-a\" class=\"scite-citeref-number\" data-reference=\"FireEye Mail CDS 2018\"><sup><a href=\"https://summit.fireeye.com/content/dam/fireeye-www/summit/cds-2018/presentations/cds18-technical-s03-youve-got-mail.pdf\" target=\"_blank\" data-hasqtip=\"8\" aria-describedby=\"qtip-8\">[9]</a></sup></span></p><h3>Outlook Rules, Forms, and Home Page</h3><p>A variety of features have been discovered in Outlook that can be abused to obtain persistence, such as Outlook rules, forms, and Home Page.<span onclick=scrollToRef('scite-10') id=\"scite-ref-10-a\" class=\"scite-citeref-number\" data-reference=\"SensePost Ruler GitHub\"><sup><a href=\"https://github.com/sensepost/ruler\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span> These persistence mechanisms can work within Outlook or be used through Office 365.<span onclick=scrollToRef('scite-11') id=\"scite-ref-11-a\" class=\"scite-citeref-number\" data-reference=\"TechNet O365 Outlook Rules\"><sup><a href=\"https://blogs.technet.microsoft.com/office365security/defending-against-rules-and-forms-injection/\" target=\"_blank\" data-hasqtip=\"10\" aria-describedby=\"qtip-10\">[11]</a></sup></span></p><p>Outlook rules allow a user to define automated behavior to manage email messages. A benign rule might, for example, automatically move an email to a particular folder in Outlook if it contains specific words from a specific sender. Malicious Outlook rules can be created that can trigger code execution when an adversary sends a specifically crafted email to that user.<span onclick=scrollToRef('scite-12') id=\"scite-ref-12-a\" class=\"scite-citeref-number\" data-reference=\"SilentBreak Outlook Rules\"><sup><a href=\"https://silentbreaksecurity.com/malicious-outlook-rules/\" target=\"_blank\" data-hasqtip=\"11\" aria-describedby=\"qtip-11\">[12]</a></sup></span></p><p>Outlook forms are used as templates for presentation and functionality in Outlook messages. Custom Outlook Forms can be created that will execute code when a specifically crafted email is sent by an adversary utilizing the same custom Outlook form.<span onclick=scrollToRef('scite-13') id=\"scite-ref-13-a\" class=\"scite-citeref-number\" data-reference=\"SensePost Outlook Forms\"><sup><a href=\"https://sensepost.com/blog/2017/outlook-forms-and-shells/\" target=\"_blank\" data-hasqtip=\"12\" aria-describedby=\"qtip-12\">[13]</a></sup></span></p><p>Outlook Home Page is a legacy feature used to customize the presentation of Outlook folders. This feature allows for an internal or external URL to be loaded and presented whenever a folder is opened. A malicious HTML page can be crafted that will execute code when loaded by Outlook Home Page.<span onclick=scrollToRef('scite-14') id=\"scite-ref-14-a\" class=\"scite-citeref-number\" data-reference=\"SensePost Outlook Home Page\"><sup><a href=\"https://sensepost.com/blog/2017/outlook-home-page-another-ruler-vector/\" target=\"_blank\" data-hasqtip=\"13\" aria-describedby=\"qtip-13\">[14]</a></sup></span></p><p>To abuse these features, an adversary requires prior access to the user\u2019s Outlook mailbox, either via an Exchange/OWA server or via the client application. Once malicious rules, forms, or Home Pages have been added to the user\u2019s mailbox, they will be loaded when Outlook is started. Malicious Home Pages will execute when the right Outlook folder is loaded/reloaded while malicious rules and forms will execute when an adversary sends a specifically crafted email to the user.<span onclick=scrollToRef('scite-12') id=\"scite-ref-12-a\" class=\"scite-citeref-number\" data-reference=\"SilentBreak Outlook Rules\"><sup><a href=\"https://silentbreaksecurity.com/malicious-outlook-rules/\" target=\"_blank\" data-hasqtip=\"11\" aria-describedby=\"qtip-11\">[12]</a></sup></span><span onclick=scrollToRef('scite-13') id=\"scite-ref-13-a\" class=\"scite-citeref-number\" data-reference=\"SensePost Outlook Forms\"><sup><a href=\"https://sensepost.com/blog/2017/outlook-forms-and-shells/\" target=\"_blank\" data-hasqtip=\"12\" aria-describedby=\"qtip-12\">[13]</a></sup></span><span onclick=scrollToRef('scite-14') id=\"scite-ref-14-a\" class=\"scite-citeref-number\" data-reference=\"SensePost Outlook Home Page\"><sup><a href=\"https://sensepost.com/blog/2017/outlook-home-page-another-ruler-vector/\" target=\"_blank\" data-hasqtip=\"13\" aria-describedby=\"qtip-13\">[14]</a></sup></span></p>", "mitigation_table": [{"mid": "M1042", "name": "Disable or Remove Feature or Program", "descr": "<p>Follow Office macro security best practices suitable for your environment. Disable Office VBA macros from executing.</p><p>Disable Office add-ins. If they are required, follow best practices for securing them by requiring them to be signed and disabling user notification for allowing add-ins. For some add-ins types (WLL, VBA) additional mitigation is likely required as disabling add-ins in the Office Trust Center does not disable WLL nor does it prevent VBA code from executing.<span onclick=scrollToRef('scite-8') id=\"scite-ref-8-a\" class=\"scite-citeref-number\" data-reference=\"MRWLabs Office Persistence Add-ins\"><sup><a href=\"https://labs.mwrinfosecurity.com/blog/add-in-opportunities-for-office-persistence/\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span></p>"}, {"mid": "M1054", "name": "Software Configuration", "descr": "<p>For the Office Test method, create the Registry key used to execute it and set the permissions to \"Read Control\" to prevent easy access to the key without administrator permissions or requiring Privilege Escalation.<span onclick=scrollToRef('scite-15') id=\"scite-ref-15-a\" class=\"scite-citeref-number\" data-reference=\"Palo Alto Office Test Sofacy\"><sup><a href=\"https://researchcenter.paloaltonetworks.com/2016/07/unit42-technical-walkthrough-office-test-persistence-method-used-in-recent-sofacy-attacks/\" target=\"_blank\" data-hasqtip=\"14\" aria-describedby=\"qtip-14\">[15]</a></sup></span></p>"}, {"mid": "M1051", "name": "Update Software", "descr": "<p>For the Outlook methods, blocking macros may be ineffective as the Visual Basic engine used for these features is separate from the macro scripting engine. Microsoft has released patches to try to address each issue. Ensure KB3191938 which blocks Outlook Visual Basic and displays a malicious code warning, KB4011091 which disables custom forms by default, and KB4011162 which removes the legacy Home Page feature, are applied to systems.<span onclick=scrollToRef('scite-13') id=\"scite-ref-13-a\" class=\"scite-citeref-number\" data-reference=\"SensePost Outlook Forms\"><sup><a href=\"https://sensepost.com/blog/2017/outlook-forms-and-shells/\" target=\"_blank\" data-hasqtip=\"12\" aria-describedby=\"qtip-12\">[13]</a></sup></span><span onclick=scrollToRef('scite-14') id=\"scite-ref-14-a\" class=\"scite-citeref-number\" data-reference=\"SensePost Outlook Home Page\"><sup><a href=\"https://sensepost.com/blog/2017/outlook-home-page-another-ruler-vector/\" target=\"_blank\" data-hasqtip=\"13\" aria-describedby=\"qtip-13\">[14]</a></sup></span></p>"}], "rel_techniques_table": [], "examples_table": [{"id": "G0007", "path": "groups", "name": "APT28", "descr": "<p><a href=\"/groups/G0007\">APT28</a> has used the Office Test persistence mechanism within Microsoft Office by adding the Registry key <code>HKCU\\Software\\Microsoft\\Office test\\Special\\Perf</code> to execute code.<span onclick=scrollToRef('scite-15') id=\"scite-ref-15-a\" class=\"scite-citeref-number\" data-reference=\"Palo Alto Office Test Sofacy\"><sup><a href=\"https://researchcenter.paloaltonetworks.com/2016/07/unit42-technical-walkthrough-office-test-persistence-method-used-in-recent-sofacy-attacks/\" target=\"_blank\" data-hasqtip=\"14\" aria-describedby=\"qtip-14\">[15]</a></sup></span></p>"}, {"id": "G0050", "path": "groups", "name": "APT32", "descr": "<p><a href=\"/groups/G0050\">APT32</a> installed a backdoor macro in Microsoft Outlook for persistence.<span onclick=scrollToRef('scite-16') id=\"scite-ref-16-a\" class=\"scite-citeref-number\" data-reference=\"Cybereason Oceanlotus May 2017\"><sup><a href=\"https://www.cybereason.com/blog/operation-cobalt-kitty-apt\" target=\"_blank\" data-hasqtip=\"15\" aria-describedby=\"qtip-15\">[16]</a></sup></span><span onclick=scrollToRef('scite-17') id=\"scite-ref-17-a\" class=\"scite-citeref-number\" data-reference=\"Cybereason Cobalt Kitty 2017\"><sup><a href=\"https://cdn2.hubspot.net/hubfs/3354902/Cybereason%20Labs%20Analysis%20Operation%20Cobalt%20Kitty.pdf\" target=\"_blank\" data-hasqtip=\"16\" aria-describedby=\"qtip-16\">[17]</a></sup></span></p>"}, {"id": "S0358", "path": "software", "name": "Ruler", "descr": "<p><a href=\"/software/S0358\">Ruler</a> can be used to automate the abuse of Outlook Rules, Forms, and Home Pages to establish persistence.<span onclick=scrollToRef('scite-10') id=\"scite-ref-10-a\" class=\"scite-citeref-number\" data-reference=\"SensePost Ruler GitHub\"><sup><a href=\"https://github.com/sensepost/ruler\" target=\"_blank\" data-hasqtip=\"9\" aria-describedby=\"qtip-9\">[10]</a></sup></span></p>"}], "version": "1.2", "tactics": ["Persistence"], "platforms": "Windows, Office 365", "sysreqs": "Office Test technique: Office 2007, 2010, 2013, 2015 and 2016; Add-ins: some require administrator permissions", "perms": "User, Administrator", "data_sources": "Process monitoring, Process command-line parameters, Windows Registry, File monitoring", "contributors": "Microsoft Threat Intelligence Center (MSTIC); Sahar Shukrun; Praetorian; Nick Carr, FireEye; Loic Jaquemet; Ricardo Dias", "detection": "<p>Many Office-related persistence mechanisms require changes to the Registry and for binaries, files, or scripts to be written to disk or existing files modified to include malicious scripts. Collect events related to Registry key creation and modification for keys that could be used for Office-based persistence.<span onclick=scrollToRef('scite-18') id=\"scite-ref-18-a\" class=\"scite-citeref-number\" data-reference=\"CrowdStrike Outlook Forms\"><sup><a href=\"https://malware.news/t/using-outlook-forms-for-lateral-movement-and-persistence/13746\" target=\"_blank\" data-hasqtip=\"17\" aria-describedby=\"qtip-17\">[18]</a></sup></span><span onclick=scrollToRef('scite-19') id=\"scite-ref-19-a\" class=\"scite-citeref-number\" data-reference=\"Outlook Today Home Page\"><sup><a href=\"https://medium.com/@bwtech789/outlook-today-homepage-persistence-33ea9b505943\" target=\"_blank\" data-hasqtip=\"18\" aria-describedby=\"qtip-18\">[19]</a></sup></span> Modification to base templated, like Normal.dotm, should also be investigated since the base templates should likely not contain VBA macros. Changes to the Office macro security settings should also be investigated.<span onclick=scrollToRef('scite-5') id=\"scite-ref-5-a\" class=\"scite-citeref-number\" data-reference=\"GlobalDotName Jun 2019\"><sup><a href=\"https://www.221bluestreet.com/post/office-templates-and-globaldotname-a-stealthy-office-persistence-technique\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span></p><p>Monitor and validate the Office trusted locations on the file system and audit the Registry entries relevant for enabling add-ins.<span onclick=scrollToRef('scite-5') id=\"scite-ref-5-a\" class=\"scite-citeref-number\" data-reference=\"GlobalDotName Jun 2019\"><sup><a href=\"https://www.221bluestreet.com/post/office-templates-and-globaldotname-a-stealthy-office-persistence-technique\" target=\"_blank\" data-hasqtip=\"4\" aria-describedby=\"qtip-4\">[5]</a></sup></span><span onclick=scrollToRef('scite-8') id=\"scite-ref-8-a\" class=\"scite-citeref-number\" data-reference=\"MRWLabs Office Persistence Add-ins\"><sup><a href=\"https://labs.mwrinfosecurity.com/blog/add-in-opportunities-for-office-persistence/\" target=\"_blank\" data-hasqtip=\"7\" aria-describedby=\"qtip-7\">[8]</a></sup></span></p><p>Non-standard process execution trees may also indicate suspicious or malicious behavior. Collect process execution information including process IDs (PID) and parent process IDs (PPID) and look for abnormal chains of activity resulting from Office processes. If winword.exe is the parent process for suspicious processes and activity relating to other adversarial techniques, then it could indicate that the application was used maliciously.</p><p>For the Outlook rules and forms methods, Microsoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output.<span onclick=scrollToRef('scite-20') id=\"scite-ref-20-a\" class=\"scite-citeref-number\" data-reference=\"Microsoft Detect Outlook Forms\"><sup><a href=\"https://docs.microsoft.com/en-us/office365/securitycompliance/detect-and-remediate-outlook-rules-forms-attack\" target=\"_blank\" data-hasqtip=\"19\" aria-describedby=\"qtip-19\">[20]</a></sup></span> SensePost, whose tool <a href=\"/software/S0358\">Ruler</a> can be used to carry out malicious rules, forms, and Home Page attacks, has released a tool to detect Ruler usage.<span onclick=scrollToRef('scite-21') id=\"scite-ref-21-a\" class=\"scite-citeref-number\" data-reference=\"SensePost NotRuler\"><sup><a href=\"https://github.com/sensepost/notruler\" target=\"_blank\" data-hasqtip=\"20\" aria-describedby=\"qtip-20\">[21]</a></sup></span></p>", "bottom_ref": [{"description": "Microsoft. (n.d.). Change the Normal template (Normal.dotm). Retrieved July 3, 2017.", "url": "https://support.office.com/article/Change-the-Normal-template-Normal-dotm-06de294b-d216-47f6-ab77-ccb5166f98ea", "sname": "Microsoft Change Normal Template", "number": 1}, {"description": "Austin, J. (2017, June 6). Getting Started with VBA in Office. Retrieved July 3, 2017.", "url": "https://msdn.microsoft.com/en-us/vba/office-shared-vba/articles/getting-started-with-vba-in-office", "sname": "MSDN VBA in Office", "number": 2}, {"description": "Nelson, M. (2014, January 23). Maintaining Access with normal.dotm. Retrieved July 3, 2017.", "url": "https://enigma0x3.net/2014/01/23/maintaining-access-with-normal-dotm/comment-page-1/", "sname": "enigma0x3 normal.dotm", "number": 3}, {"description": "Hexacorn. (2017, April 17). Beyond good ol\u2019 Run key, Part 62. Retrieved July 3, 2017.", "url": "http://www.hexacorn.com/blog/2017/04/19/beyond-good-ol-run-key-part-62/", "sname": "Hexacorn Office Template Macros", "number": 4}, {"description": "Shukrun, S. (2019, June 2). Office Templates and GlobalDotName - A Stealthy Office Persistence Technique. Retrieved August 26, 2019.", "url": "https://www.221bluestreet.com/post/office-templates-and-globaldotname-a-stealthy-office-persistence-technique", "sname": "GlobalDotName Jun 2019", "number": 5}, {"description": "Hexacorn. (2014, April 16). Beyond good ol\u2019 Run key, Part 10. Retrieved July 3, 2017.", "url": "http://www.hexacorn.com/blog/2014/04/16/beyond-good-ol-run-key-part-10/", "sname": "Hexacorn Office Test", "number": 6}, {"description": "Microsoft. (n.d.). Add or remove add-ins. Retrieved July 3, 2017.", "url": "https://support.office.com/article/Add-or-remove-add-ins-0af570c4-5cf3-4fa9-9b88-403625a0b460", "sname": "Microsoft Office Add-ins", "number": 7}, {"description": "Knowles, W. (2017, April 21). Add-In Opportunities for Office Persistence. Retrieved July 3, 2017.", "url": "https://labs.mwrinfosecurity.com/blog/add-in-opportunities-for-office-persistence/", "sname": "MRWLabs Office Persistence Add-ins", "number": 8}, {"description": "Caban, D. and Hirani, M. (2018, October 3). You\u2019ve Got Mail! Enterprise Email Compromise. Retrieved April 22, 2019.", "url": "https://summit.fireeye.com/content/dam/fireeye-www/summit/cds-2018/presentations/cds18-technical-s03-youve-got-mail.pdf", "sname": "FireEye Mail CDS 2018", "number": 9}, {"description": "SensePost. (2016, August 18). Ruler: A tool to abuse Exchange services. Retrieved February 4, 2019.", "url": "https://github.com/sensepost/ruler", "sname": "SensePost Ruler GitHub", "number": 10}, {"description": "Koeller, B.. (2018, February 21). Defending Against Rules and Forms Injection. Retrieved November 5, 2019.", "url": "https://blogs.technet.microsoft.com/office365security/defending-against-rules-and-forms-injection/", "sname": "TechNet O365 Outlook Rules", "number": 11}, {"description": "Landers, N. (2015, December 4). Malicious Outlook Rules. Retrieved February 4, 2019.", "url": "https://silentbreaksecurity.com/malicious-outlook-rules/", "sname": "SilentBreak Outlook Rules", "number": 12}, {"description": "Stalmans, E. (2017, April 28). Outlook Forms and Shells. Retrieved February 4, 2019.", "url": "https://sensepost.com/blog/2017/outlook-forms-and-shells/", "sname": "SensePost Outlook Forms", "number": 13}, {"description": "Stalmans, E. (2017, October 11). Outlook Home Page \u2013 Another Ruler Vector. Retrieved February 4, 2019.", "url": "https://sensepost.com/blog/2017/outlook-home-page-another-ruler-vector/", "sname": "SensePost Outlook Home Page", "number": 14}, {"description": "Falcone, R. (2016, July 20). Technical Walkthrough: Office Test Persistence Method Used In Recent Sofacy Attacks. Retrieved July 3, 2017.", "url": "https://researchcenter.paloaltonetworks.com/2016/07/unit42-technical-walkthrough-office-test-persistence-method-used-in-recent-sofacy-attacks/", "sname": "Palo Alto Office Test Sofacy", "number": 15}, {"description": "Dahan, A. (2017, May 24). OPERATION COBALT KITTY: A LARGE-SCALE APT IN ASIA CARRIED OUT BY THE OCEANLOTUS GROUP. Retrieved November 5, 2018.", "url": "https://www.cybereason.com/blog/operation-cobalt-kitty-apt", "sname": "Cybereason Oceanlotus May 2017", "number": 16}, {"description": "Dahan, A. (2017). Operation Cobalt Kitty. Retrieved December 27, 2018.", "url": "https://cdn2.hubspot.net/hubfs/3354902/Cybereason%20Labs%20Analysis%20Operation%20Cobalt%20Kitty.pdf", "sname": "Cybereason Cobalt Kitty 2017", "number": 17}, {"description": "Parisi, T., et al. (2017, July). Using Outlook Forms for Lateral Movement and Persistence. Retrieved February 5, 2019.", "url": "https://malware.news/t/using-outlook-forms-for-lateral-movement-and-persistence/13746", "sname": "CrowdStrike Outlook Forms", "number": 18}, {"description": "Soutcast. (2018, September 14). Outlook Today Homepage Persistence. Retrieved February 5, 2019.", "url": "https://medium.com/@bwtech789/outlook-today-homepage-persistence-33ea9b505943", "sname": "Outlook Today Home Page", "number": 19}, {"description": "Fox, C., Vangel, D. (2018, April 22). Detect and Remediate Outlook Rules and Custom Forms Injections Attacks in Office 365. Retrieved February 4, 2019.", "url": "https://docs.microsoft.com/en-us/office365/securitycompliance/detect-and-remediate-outlook-rules-forms-attack", "sname": "Microsoft Detect Outlook Forms", "number": 20}, {"description": "SensePost. (2017, September 21). NotRuler - The opposite of Ruler, provides blue teams with the ability to detect Ruler usage against Exchange. Retrieved February 4, 2019.", "url": "https://github.com/sensepost/notruler", "sname": "SensePost NotRuler", "number": 21}]}