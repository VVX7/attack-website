Title: Execution-enterprise
Template: tactics/tactic
save_as: tactics/TA0002/index.html
data: {"attack_id": "TA0002", "name": "Execution", "name_lower": "execution", "descr": "<p>The adversary is trying to run malicious code.</p>\n<p>Execution consists of techniques that result in adversary-controlled code running on a local or remote system. Techniques that run malicious code are often paired with techniques from all other tactics to achieve broader goals, like exploring a network or stealing data. For example, an adversary might use a remote access tool to run a PowerShell script that does Remote System Discovery. </p>", "side_menu_data": {"name": "tactics", "id": "tactics", "path": "/tactics/enterprise/", "children": [{"name": "Initial Access", "id": "Initial Access", "path": "/tactics/TA0001/", "children": []}, {"name": "Execution", "id": "Execution", "path": "/tactics/TA0002/", "children": []}, {"name": "Persistence", "id": "Persistence", "path": "/tactics/TA0003/", "children": []}, {"name": "Privilege Escalation", "id": "Privilege Escalation", "path": "/tactics/TA0004/", "children": []}, {"name": "Defense Evasion", "id": "Defense Evasion", "path": "/tactics/TA0005/", "children": []}, {"name": "Credential Access", "id": "Credential Access", "path": "/tactics/TA0006/", "children": []}, {"name": "Discovery", "id": "Discovery", "path": "/tactics/TA0007/", "children": []}, {"name": "Lateral Movement", "id": "Lateral Movement", "path": "/tactics/TA0008/", "children": []}, {"name": "Collection", "id": "Collection", "path": "/tactics/TA0009/", "children": []}, {"name": "Command and Control", "id": "Command and Control", "path": "/tactics/TA0011/", "children": []}, {"name": "Exfiltration", "id": "Exfiltration", "path": "/tactics/TA0010/", "children": []}, {"name": "Impact", "id": "Impact", "path": "/tactics/TA0040/", "children": []}]}, "domain": "enterprise", "techniques_table": [{"tid": "T1155", "descr": "<p>macOS and OS X applications send AppleEvent messages to each other for interprocess communications (IPC). These messages can be easily scripted with AppleScript for local or remote IPC. Osascript executes AppleScript and any other Open Scripting Architecture (OSA) language scripts. A list of OSA languages installed on a system can be found by using the <code>osalang</code> program.</p>", "technique_name": "AppleScript"}, {"tid": "T1191", "descr": "<p>The Microsoft Connection Manager Profile Installer (CMSTP.exe) is a command-line program used to install Connection Manager service profiles.  CMSTP.exe accepts an installation information file (INF) as a parameter and installs a service profile leveraged for remote access connections.</p>", "technique_name": "CMSTP"}, {"tid": "T1059", "descr": "<p>Command-line interfaces provide a way of interacting with computer systems and is a common feature across many types of operating system platforms.  One example command-line interface on Windows systems is <a href=\"/software/S0106\">cmd</a>, which can be used to perform a number of tasks including execution of other software. Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc. Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g. <a href=\"/techniques/T1053\">Scheduled Task</a>).</p>", "technique_name": "Command-Line Interface"}, {"tid": "T1223", "descr": "<p>Compiled HTML files (.chm) are commonly distributed as part of the Microsoft HTML Help system. CHM files are compressed compilations of various content such as HTML documents, images, and scripting/web related programming languages such VBA, JScript, Java, and ActiveX.  CHM content is displayed using underlying components of the Internet Explorer browser  loaded by the HTML Help executable program (hh.exe). </p>", "technique_name": "Compiled HTML File"}, {"tid": "T1175", "descr": "<p>Adversaries may use the Windows Component Object Model (COM) and Distributed Component Object Model (DCOM) for local code execution or to execute on remote systems as part of lateral movement. </p>", "technique_name": "Component Object Model and Distributed COM"}, {"tid": "T1196", "descr": "<p>Windows Control Panel items are utilities that allow users to view and adjust computer settings. Control Panel items are registered executable (.exe) or Control Panel (.cpl) files, the latter are actually renamed dynamic-link library (.dll) files that export a CPlApplet function.   Control Panel items can be executed directly from the command line, programmatically via an application programming interface (API) call, or by simply double-clicking the file.   </p>", "technique_name": "Control Panel Items"}, {"tid": "T1173", "descr": "<p>Windows Dynamic Data Exchange (DDE) is a client-server protocol for one-time and/or continuous inter-process communication (IPC) between applications. Once a link is established, applications can autonomously exchange transactions consisting of strings, warm data links (notifications when a data item changes), hot data links (duplications of changes to a data item), and requests for command execution.</p>", "technique_name": "Dynamic Data Exchange"}, {"tid": "T1106", "descr": "<p>Adversary tools may directly use the Windows application programming interface (API) to execute binaries. Functions such as the Windows API CreateProcess will allow programs and scripts to start other processes with proper path and argument parameters. </p>", "technique_name": "Execution through API"}, {"tid": "T1129", "descr": "<p>The Windows module loader can be instructed to load DLLs from arbitrary local paths and arbitrary Universal Naming Convention (UNC) network paths. This functionality resides in NTDLL.dll and is part of the Windows Native API which is called from functions like CreateProcess(), LoadLibrary(), etc. of the Win32 API. </p>", "technique_name": "Execution through Module Load"}, {"tid": "T1203", "descr": "<p>Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility.</p>", "technique_name": "Exploitation for Client Execution"}, {"tid": "T1061", "descr": "<p>The Graphical User Interfaces (GUI) is a common way to interact with an operating system. Adversaries may use a system's GUI during an operation, commonly through a remote interactive session such as <a href=\"/techniques/T1076\">Remote Desktop Protocol</a>, instead of through a <a href=\"/techniques/T1059\">Command-Line Interface</a>, to search for information and execute files via mouse double-click events, the Windows Run command , or other potentially difficult to monitor interactions.</p>", "technique_name": "Graphical User Interface"}, {"tid": "T1118", "descr": "<p>InstallUtil is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries.  InstallUtil is located in the .NET directories on a Windows system: <code>C:\\Windows\\Microsoft.NET\\Framework\\v<version>\\InstallUtil.exe</code> and <code>C:\\Windows\\Microsoft.NET\\Framework64\\v<version>\\InstallUtil.exe</code>. InstallUtil.exe is digitally signed by Microsoft.</p>", "technique_name": "InstallUtil"}, {"tid": "T1152", "descr": "<p>Launchctl controls the macOS launchd process which handles things like launch agents and launch daemons, but can execute other commands or programs itself. Launchctl supports taking subcommands on the command-line, interactively, or even redirected from standard input. By loading or reloading launch agents or launch daemons, adversaries can install persistence or execute changes they made  . Running a command from launchctl is as simple as <code>launchctl submit -l <labelName> -- /Path/to/thing/to/execute \"arg\" \"arg\" \"arg\"</code>. Loading, unloading, or reloading launch agents or launch daemons can require elevated privileges. </p>", "technique_name": "Launchctl"}, {"tid": "T1168", "descr": "<p>On Linux and macOS systems, multiple methods are supported for creating pre-scheduled and periodic background jobs: cron,  at,  and launchd.  Unlike <a href=\"/techniques/T1053\">Scheduled Task</a> on Windows systems, job scheduling on Linux-based systems cannot be done remotely unless used in conjunction within an established remote session, like secure shell (SSH).</p>", "technique_name": "Local Job Scheduling"}, {"tid": "T1177", "descr": "<p>The Windows security subsystem is a set of components that manage and enforce the security policy for a computer or domain. The Local Security Authority (LSA) is the main component responsible for local security policy and user authentication. The LSA includes multiple dynamic link libraries (DLLs) associated with various other security functions, all of which run in the context of the LSA Subsystem Service (LSASS) lsass.exe process. </p>", "technique_name": "LSASS Driver"}, {"tid": "T1170", "descr": "<p>Mshta.exe is a utility that executes Microsoft HTML Applications (HTA). HTA files have the file extension <code>.hta</code>.  HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser. </p>", "technique_name": "Mshta"}, {"tid": "T1086", "descr": "<p>PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system.  Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer. </p>", "technique_name": "PowerShell"}, {"tid": "T1121", "descr": "<p>Regsvcs and Regasm are Windows command-line utilities that are used to register .NET Component Object Model (COM) assemblies. Both are digitally signed by Microsoft.  </p>", "technique_name": "Regsvcs/Regasm"}, {"tid": "T1117", "descr": "<p>Regsvr32.exe is a command-line program used to register and unregister object linking and embedding controls, including dynamic link libraries (DLLs), on Windows systems. Regsvr32.exe can be used to execute arbitrary binaries. </p>", "technique_name": "Regsvr32"}, {"tid": "T1085", "descr": "<p>The rundll32.exe program can be called to execute an arbitrary binary. Adversaries may take advantage of this functionality to proxy execution of code to avoid triggering security tools that may not monitor execution of the rundll32.exe process because of whitelists or false positives from Windows using rundll32.exe for normal operations.</p>", "technique_name": "Rundll32"}, {"tid": "T1053", "descr": "<p>Utilities such as <a href=\"/software/S0110\">at</a> and <a href=\"/software/S0111\">schtasks</a>, along with the Windows Task Scheduler, can be used to schedule programs or scripts to be executed at a date and time. A task can also be scheduled on a remote system, provided the proper authentication is met to use RPC and file and printer sharing is turned on. Scheduling a task on a remote system typically required being a member of the Administrators group on the remote system. </p>", "technique_name": "Scheduled Task"}, {"tid": "T1064", "descr": "<p>Adversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual. Scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources. Some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an API level instead of calling other programs. Common scripting languages for Windows include VBScript and <a href=\"/techniques/T1086\">PowerShell</a> but could also be in the form of command-line batch scripts.</p>", "technique_name": "Scripting"}, {"tid": "T1035", "descr": "<p>Adversaries may execute a binary, command, or script via a method that interacts with Windows services, such as the Service Control Manager. This can be done by either creating a new service or modifying an existing service. This technique is the execution used in conjunction with <a href=\"/techniques/T1050\">New Service</a> and <a href=\"/techniques/T1031\">Modify Existing Service</a> during service persistence or privilege escalation.</p>", "technique_name": "Service Execution"}, {"tid": "T1218", "descr": "<p>Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation. Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files. This behavior may be abused by adversaries to execute malicious files that could bypass application whitelisting and signature validation on systems. This technique accounts for proxy execution methods that are not already accounted for within the existing techniques.</p>", "technique_name": "Signed Binary Proxy Execution"}, {"tid": "T1216", "descr": "<p>Scripts signed with trusted certificates can be used to proxy execution of malicious files. This behavior may bypass signature validation restrictions and application whitelisting solutions that do not account for use of these scripts.</p>", "technique_name": "Signed Script Proxy Execution"}, {"tid": "T1153", "descr": "<p>The <code>source</code> command loads functions into the current shell or executes files in the current context. This built-in command can be run in two different ways <code>source /path/to/filename [arguments]</code> or <code>. /path/to/filename [arguments]</code>. Take note of the space after the \".\". Without a space, a new shell is created that runs the program instead of running the program within the current context. This is often used to make certain features or functions available to a shell or to update a specific shell's environment.</p>", "technique_name": "Source"}, {"tid": "T1151", "descr": "<p>Adversaries can hide a program's true filetype by changing the extension of a file. With certain file types (specifically this does not work with .app extensions), appending a space to the end of a filename will change how the file is processed by the operating system. For example, if there is a Mach-O executable file called evil.bin, when it is double clicked by a user, it will launch Terminal.app and execute. If this file is renamed to evil.txt, then when double clicked by a user, it will launch with the default text editing application (not executing the binary). However, if the file is renamed to \"evil.txt \" (note the space at the end), then when double clicked by a user, the true file type is determined by the OS and handled appropriately and the binary will be executed . </p>", "technique_name": "Space after Filename"}, {"tid": "T1072", "descr": "<p>Third-party applications and software deployment systems may be in use in the network environment for administration purposes (e.g., SCCM, VNC, HBSS, Altiris, etc.). If an adversary gains access to these systems, then they may be able to execute code.</p>", "technique_name": "Third-party Software"}, {"tid": "T1154", "descr": "<p>The <code>trap</code> command allows programs and shells to specify commands that will be executed upon receiving interrupt signals. A common situation is a script allowing for graceful termination and handling of common  keyboard interrupts like <code>ctrl+c</code> and <code>ctrl+d</code>. Adversaries can use this to register code to be executed when the shell encounters specific interrupts either to gain execution or as a persistence mechanism. Trap commands are of the following format <code>trap 'command list' signals</code> where \"command list\" will be executed when \"signals\" are received.</p>", "technique_name": "Trap"}, {"tid": "T1127", "descr": "<p>There are many utilities used for software development related tasks that can be used to execute code in various forms to assist in development, debugging, and reverse engineering. These utilities may often be signed with legitimate certificates that allow them to execute on a system and proxy execution of malicious code through a trusted process that effectively bypasses application whitelisting defensive solutions.</p>", "technique_name": "Trusted Developer Utilities"}, {"tid": "T1204", "descr": "<p>An adversary may rely upon specific actions by a user in order to gain execution. This may be direct code execution, such as when a user opens a malicious executable delivered via <a href=\"/techniques/T1193\">Spearphishing Attachment</a> with the icon and apparent extension of a document file. It also may lead to other execution techniques, such as when a user clicks on a link delivered via <a href=\"/techniques/T1192\">Spearphishing Link</a> that leads to exploitation of a browser or application vulnerability via <a href=\"/techniques/T1203\">Exploitation for Client Execution</a>. Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl. </p>", "technique_name": "User Execution"}, {"tid": "T1047", "descr": "<p>Windows Management Instrumentation (WMI) is a Windows administration feature that provides a uniform environment for local and remote access to Windows system components. It relies on the WMI service for local and remote access and the server message block (SMB)  and Remote Procedure Call Service (RPCS)  for remote access. RPCS operates over port 135. </p>", "technique_name": "Windows Management Instrumentation"}, {"tid": "T1028", "descr": "<p>Windows Remote Management (WinRM) is the name of both a Windows service and a protocol that allows a user to interact with a remote system (e.g., run an executable, modify the Registry, modify services).  It may be called with the <code>winrm</code> command or by any number of programs such as PowerShell. </p>", "technique_name": "Windows Remote Management"}, {"tid": "T1220", "descr": "<p>Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files. To support complex operations, the XSL standard includes support for embedded scripting in various languages. </p>", "technique_name": "XSL Script Processing"}], "techniques_table_len": "34"}